<!DOCTYPE html>
<html lang="ku">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø³ÛŒØ³ØªÛ•Ù…ÛŒ Ù‚Û•Ø±Ø²ÛŒ - Ø±Û†Ù†ÛŒÚ©Ø§</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Ø³ÛŒØ³ØªÛ•Ù…ÛŒ Ù‚Û•Ø±Ø² - Ø±Û†Ù†ÛŒÚ©Ø§</title>
    
   <meta name="theme-color" content="#3498db">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<link rel="manifest" href="./manifest.json">
<link rel="icon" href="./icons/icon-192.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vazirmatn@latest/Vazirmatn-font-face.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
      /* Ù…Ø¯ÛŒØ±ÛŒØª ØµÙØ­Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ PDF */
@media print {
    .excel-table {
        page-break-inside: avoid;  /* Ø§Ø² Ø´Ú©Ø³ØªÙ† Ø¬Ø¯ÙˆÙ„ Ø¯Ø± ÙˆØ³Ø· Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ù…ÛŒÚ©Ù†Ø¯ */
        break-inside: avoid;       /* Ù†Ø³Ø®Ù‡ Ù…Ø¯Ø±Ù† Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø´Ú©Ø³ØªÙ† */
    }
    
    .excel-style-report {
        page-break-inside: avoid;  /* Ø§Ø² Ø´Ú©Ø³ØªÙ† Ú¯Ø²Ø§Ø±Ø´ Ø¯Ø± ÙˆØ³Ø· Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ù…ÛŒÚ©Ù†Ø¯ */
        break-inside: avoid;       /* Ù†Ø³Ø®Ù‡ Ù…Ø¯Ø±Ù† */
    }
}

/* Ú©Ù„Ø§Ø³ Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø´Ú©Ø³ØªÙ† ØµÙØ­Ù‡ */
.keep-together {
    page-break-inside: avoid;      /* Ø§Ù„Ù…Ø§Ù† Ø¯Ø± ÛŒÚ© ØµÙØ­Ù‡ Ù…ÛŒÙ…Ø§Ù†Ø¯ */
    break-inside: avoid;           /* Ù†Ø³Ø®Ù‡ Ù…Ø¯Ø±Ù† */
}

      /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ú¯Ø²Ø§Ø±Ø´Ø§Øª - ØªÙ… Ø§Ú©Ø³Ù„ÛŒ */
.excel-style-report {
    background: #ffffff;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.excel-header {
    background: linear-gradient(135deg, #2c3e50, #34495e);
    color: white;
    padding: 20px;
    text-align: center;
    border-bottom: 3px solid #3498db;
}

.excel-header h3 {
    margin: 0;
    font-size: 24px;
    font-weight: 700;
}

.excel-subheader {
    background: #f8f9fa;
    padding: 15px 20px;
    border-bottom: 1px solid #dee2e6;
    font-weight: 600;
    color: #495057;
}

.excel-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 0;
}

.excel-card {
    padding: 20px;
    border-right: 1px solid #dee2e6;
    border-bottom: 1px solid #dee2e6;
    background: #fff;
}

.excel-card:last-child {
    border-right: none;
}

.excel-card h4 {
    color: #2c3e50;
    margin-bottom: 15px;
    font-size: 16px;
    font-weight: 700;
    border-bottom: 2px solid #3498db;
    padding-bottom: 8px;
}

.excel-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 0;
    border-bottom: 1px solid #f8f9fa;
}

.excel-item:last-child {
    border-bottom: none;
}

.excel-item label {
    font-weight: 600;
    color: #495057;
    font-size: 16px;
}

.excel-item span {
    color: #e74c3c;
    font-weight: 700;
    font-size: 16px;
}

.excel-history {
    padding: 20px;
}

.excel-history h4 {
    color: #2c3e50;
    margin-bottom: 15px;
    font-size: 16px;
    font-weight: 700;
    border-bottom: 2px solid #3498db;
    padding-bottom: 8px;
}

.excel-history-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.excel-history-item {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 15px;
    padding: 12px 15px;
    background: #f8f9fa;
    border-radius: 6px;
    border-right: 4px solid #27ae60;
    align-items: center;
}

.excel-history-number {
    color: #2c3e50;
    font-weight: 600;
}

.excel-history-amount {
    color: #e74c3c;
    font-weight: 700;
    text-align: left;
}

.excel-history-date {
    color: #7f8c8d;
    text-align: left;
}

/* Ø¯Ú©Ù…Ù‡ PDF */
.pdf-btn-container {
    display: flex;
    justify-content: flex-end; /* Ø³Ù…Øª Ú†Ù¾ */
    margin: 20px 0;
}

.btn-pdf {
    background: linear-gradient(135deg, #e74c3c, #c0392b);
    color: white;
    border: none;
    padding: 12px 25px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 16px;
    font-weight: 600;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    box-shadow: 0 2px 4px rgba(231, 76, 60, 0.3);
}

.btn-pdf:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(231, 76, 60, 0.4);
    background: linear-gradient(135deg, #c0392b, #a93226);
}

/* ÙˆØ³Ø· Ú†ÛŒÙ† Ú©Ø±Ø¯Ù† Ú©Ù„ ØªØ¨â€ŒÙ‡Ø§ Ùˆ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ */
.tab-content {
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.installment-container,
.form-container {
    width: 100%;
    max-width: 900px;
    margin: 0 auto;
}

.excel-style-report {
    margin: 0 auto;
    max-width: 1000px;
}

.excel-grid {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
}

.excel-card {
    width: 100%;
    max-width: 600px;
    margin: 0 auto;
}

/* ØªÙ… Ø§Ú©Ø³Ù„ÛŒ ÙˆØ§Ù‚Ø¹ÛŒ Ø¨Ø§ Ø¬Ø¯ÙˆÙ„ */
.excel-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    font-size: 16px;
    background: white;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
}

.excel-table th {
    background: linear-gradient(135deg, #2c3e50, #34495e);
    color: white;
    padding: 12px 15px;
    text-align: center;
    border: 1px solid #1a252f;
    font-weight: 700;
}

.excel-table td {
    padding: 10px 15px;
    border: 1px solid #ddd;
    text-align: center;
}

.excel-table tr:nth-child(even) {
    background-color: #f8f9fa;
}

.excel-table tr:hover {
    background-color: #e3f2fd;
}

.excel-table .total-row {
    background: #e8f5e8 !important;
    font-weight: 700;
    border-top: 2px solid #27ae60;
}

.excel-table .total-row td {
    color: #2c3e50;
    font-size: 15px;
}

.excel-table .amount {
    font-weight: 700;
    color: #e74c3c;
}

.excel-table .paid {
    font-weight: 700;
    color: #27ae60;
}

.excel-table .remaining {
    font-weight: 700;
    color: #e67e22;
}

.excel-table .loan-header {
    background: #3498db !important;
    color: white;
    font-size: 16px;
    font-weight: 700;
}

/* ÙˆØ³Ø· Ú†ÛŒÙ† Ú©Ø±Ø¯Ù† Ú©Ø§Ù…Ù„ Ø¨Ø±Ø§ÛŒ Ú¯Ø²Ø§Ø±Ø´Ø§Øª */
.excel-style-report {
    text-align: center;
    margin: 0 auto;
}

/* Ø¨Ù‡Ø¨ÙˆØ¯ Ù…Ø¯ÛŒØ±ÛŒØª ØµÙØ­Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ PDF */
.excel-table {
    page-break-inside: auto !important;
}

.excel-table tr {
    page-break-inside: avoid !important;
    page-break-after: auto !important;
}

.excel-table td, .excel-table th {
    page-break-inside: avoid !important;
}

/* Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ø§ÛŒÙ†Ú©Ù‡ Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§ Ø¨Ø§ Ù‡Ù… Ù…ÛŒâ€ŒÙ…Ø§Ù†Ù†Ø¯ */
.excel-table tbody tr {
    break-inside: avoid-page !important;
}

/* Ø§ÛŒÙ†Ø¬Ø§ Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ PDF Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†: */

/* Ù…Ø¯ÛŒØ±ÛŒØª ØµÙØ­Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ PDF */
@media print {
    .excel-table {
        page-break-inside: avoid;
        break-inside: avoid;
    }
    
    .excel-style-report {
        page-break-inside: avoid;
        break-inside: avoid;
    }
}

/* Ú©Ù„Ø§Ø³ Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø´Ú©Ø³ØªÙ† ØµÙØ­Ù‡ */
.keep-together {
    page-break-inside: avoid;
    break-inside: avoid;
}

/* Ùˆ Ø§ÛŒÙ†Ø¬Ø§ Ø§Ø¯Ø§Ù…Ù‡ Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ */
@media (max-width: 768px) {
    /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ */
}

@media (max-width: 768px) {
    .excel-grid {
        grid-template-columns: 1fr;
    }
    
    .excel-history-item {
        grid-template-columns: 1fr;
        gap: 8px;
    }
}
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Vazirmatn, sans-serif;
        }

        body {
            font-family: Vazirmatn, sans-serif;
            line-height: 1.6;
            background-color: #f5f5f5;
            color: #333;
            direction: rtl;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        header h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 20px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .tab-button {
            padding: 12px 24px;
            border: none;
            background: #ecf0f1;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            font-weight: 500;
        }

        .tab-button:hover {
            background: #d5dbdb;
        }

        .tab-button.active {
            background: #3498db;
            color: white;
        }

        .tab-content {
            display: none;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .tab-content.active {
            display: block;
        }

        .tab-content h2 {
            color: #2c3e50;
            margin-bottom: 25px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }

        .form-container {
            max-width: 800px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
        }

        .amount-input {
            text-align: left;
            direction: ltr;
        }

        .readonly {
            background-color: #f8f9fa;
            color: #6c757d;
        }

        .form-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            position: relative;
        }

        .btn-primary,
        .btn-secondary {
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #27ae60;
            color: white;
        }

        .btn-primary:hover {
            background: #219a52;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .success-message {
            color: #27ae60;
            font-weight: bold;
            margin-top: 10px;
            text-align: center;
            padding: 10px;
            background: #d4edda;
            border-radius: 5px;
            display: none;
        }

        .info-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .info-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-right: 4px solid #3498db;
        }

        .info-card h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
            font-size: 16px;
        }

        .card-content {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .card-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 6px 0;
            border-bottom: 1px solid #f8f9fa;
        }

        .card-item label {
            font-weight: 600;
            color: #2c3e50;
            font-size: 13px;
        }

        .card-item span {
            color: #e74c3c;
            font-weight: 600;
            font-size: 13px;
        }

        .history-section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-top: 20px;
        }

        .history-section h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
        }

        .history-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 5px;
            border-right: 3px solid #27ae60;
        }

        .history-item span {
            font-weight: 500;
        }

        .history-number {
            color: #2c3e50;
            min-width: 100px;
        }

        .history-amount {
            color: #e74c3c;
            font-weight: 600;
            min-width: 120px;
            text-align: left;
        }

        .history-date {
            color: #7f8c8d;
            min-width: 120px;
            text-align: left;
        }

        .installment-container {
            max-width: 600px;
        }

        .report-section {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-right: 4px solid #3498db;
        }

        .investors-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            margin-bottom: 30px;
        }

        .investors-table th,
        .investors-table td {
            padding: 12px;
            text-align: right;
            border: 1px solid #ddd;
        }

        .investors-table th {
            background: #3498db;
            color: white;
        }

        .investors-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .summary-section {
            margin-top: 30px;
            padding: 20px;
            background: #e8f5e8;
            border-radius: 8px;
            border: 1px solid #27ae60;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: white;
            border-radius: 5px;
        }

        .info-item label {
            font-weight: 600;
            color: #2c3e50;
        }

        .info-item span {
            color: #e74c3c;
            font-weight: 600;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #3498db;
        }

        .error-message {
            color: #e74c3c;
            background: #fadbd8;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
        }

        .test-connection-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ ØªØ¨ Ú¯Ø²Ø§Ø±Ø´Ø§Øª */
        .modern-dashboard {
    background: linear-gradient(135deg, #2c3e50, #34495e);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            color: white;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .dashboard-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .dashboard-header h2 {
            font-size: 28px;
            margin-bottom: 10px;
            font-weight: 700;
            color: white;
        }
        
        .dashboard-header p {
            opacity: 0.9;
            font-size: 16px;
        }
        .dashboard-header h2 {
    color: white !important;
    font-weight: 700;
}

        .stats-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 30px;
}
        
        .stat-card {
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(20px);
    border-radius: 20px;
    padding: 25px;
    text-align: center;
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    transition: all 0.3s ease;
}
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }
        
        .stat-card.primary {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
        }
        
        .stat-card.success {
            background: linear-gradient(135deg, #1dd1a1, #10ac84);
        }
        
        .stat-card.warning {
            background: linear-gradient(135deg, #feca57, #ff9f43);
        }
        
        .stat-card.info {
            background: linear-gradient(135deg, #54a0ff, #2e86de);
        }

        .stat-card:nth-child(1) { background: linear-gradient(135deg, #3498db, #2980b9); }
.stat-card:nth-child(2) { background: linear-gradient(135deg, #1abc9c, #16a085); }
.stat-card:nth-child(3) { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
.stat-card:nth-child(4) { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        
        .stat-icon {
            font-size: 40px;
            margin-bottom: 15px;
            opacity: 0.9;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 16px;
            opacity: 0.9;
            font-weight: 500;
        }
        
        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .chart-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border: 1px solid #e8e8e8;
        }
        
        .chart-card h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 600;
            border-bottom: 2px solid #f8f9fa;
            padding-bottom: 10px;
        }
        
        .progress-ring {
            width: 120px;
            height: 120px;
            margin: 0 auto 20px;
        }
        
        .progress-bg {
            fill: none;
            stroke: #ecf0f1;
            stroke-width: 8;
        }
        
        .progress-fill {
            fill: none;
            stroke: #3498db;
            stroke-width: 8;
            stroke-linecap: round;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
            transition: stroke-dashoffset 0.3s ease;
        }
        
        .progress-text {
            text-anchor: middle;
            dominant-baseline: middle;
            font-size: 24px;
            font-weight: bold;
            fill: #2c3e50;
        }
        
        .progress-label {
            text-align: center;
            color: #7f8c8d;
            font-size: 16px;
        }
        
        .loan-distribution {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .distribution-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            border-right: 4px solid #3498db;
        }
        
        .distribution-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        
        .distribution-info {
            flex: 1;
        }
        
        .distribution-value {
            font-weight: 600;
            color: #2c3e50;
        }
        
        .distribution-label {
            font-size: 12px;
            color: #7f8c8d;
        }
        
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }
        
        .action-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        
        .action-btn.success {
            background: linear-gradient(135deg, #27ae60, #219a52);
        }
        
        .action-btn.warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .update-btn {
            background: #9b59b6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
            transition: all 0.3s ease;
        }

        .update-btn:hover {
            background: #8e44ad;
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .info-cards {
                grid-template-columns: 1fr;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .investors-table {
                font-size: 12px;
            }
            
            .card-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            
            .history-item {
                flex-direction: column;
                gap: 8px;
                align-items: flex-start;
            }
            
            .history-number,
            .history-amount,
            .history-date {
                min-width: auto;
                text-align: right;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .charts-container {
                grid-template-columns: 1fr;
            }
            
            .quick-actions {
                grid-template-columns: 1fr;
            }
            
            .modern-dashboard {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Ø³ÛŒØ³ØªÛ•Ù…ÛŒ Ù‚Û•Ø±Ø²ÛŒ - Ø±Û†Ù†ÛŒÚ©Ø§</h1>
            <nav class="tabs">
                <button class="tab-button active" onclick="openTab('new-loan')">Ù‚Û•Ø±Ø²ÛŒ Ù†ÙˆÛ</button>
                <button class="tab-button" onclick="openTab('receive-installment')">ÙˆÛ•Ø±Ú¯Ø±ØªÙ†ÛŒ Ù‚ÛŒØ³Øª</button>
                <button class="tab-button" onclick="openTab('waragr-reports')">Ø±Ø§Ù¾Û†Ø±ØªÛŒ ÙˆÛ•Ø±Ú¯Ø±Û•Ú©Ø§Ù†</button>
                <button class="tab-button" onclick="openTab('reports')">Ú•Ø§Ù¾Û†Ø±ØªÛ•Ú©Ø§Ù†</button>
                <button class="tab-button" onclick="openTab('investors')">Ø®Ø§ÙˆÛ•Ù† Ù¾Ø´Ú©Û•Ú©Ø§Ù†</button>
            </nav>
        </header>

        <!-- ØªØ¨ Ù‚Û•Ø±Ø²ÛŒ Ù†ÙˆÛ -->
        <div id="new-loan" class="tab-content active">
            <h2>ØªÛ†Ù…Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ù‚Û•Ø±Ø²ÛŒ Ù†ÙˆÛ</h2>
            <form id="loan-form" class="form-container">
                <div class="form-group">
                    <label for="waragr">Ù†Ø§ÙˆÛŒ ÙˆÛ•Ø±Ú¯Ø±</label>
                    <input type="text" id="waragr" required>
                </div>
                
                <div class="form-group">
                    <label for="mobile-waragr">Ù…Û†Ø¨Ø§ÛŒÙ„ÛŒ ÙˆÛ•Ø±Ú¯Ø±</label>
                    <input type="text" id="mobile-waragr">
                </div>

                <div class="form-group">
                    <label for="jor-qist">Ø¬Û†Ø±ÛŒ Ù‚ÛŒØ³Øª</label>
                    <input type="text" id="jor-qist">
                </div>

                <div class="form-group">
                    <label for="beruar">Ø¨Û•Ø±ÙˆØ§Ø±</label>
                    <input type="date" id="beruar" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="kreen">Ú©Ø±ÛŒÙ† (Ù…Û•Ø¨Ù„Û•ØºÛŒ Ù‚Û•Ø±Ø²)</label>
                        <input type="text" id="kreen" class="amount-input" required>
                    </div>

                    <div class="form-group">
                        <label for="froshtn">ÙØ±Û†Ø´ØªÙ† (Ù…Û•Ø¨Ù„Û•Øº Ø¯ÙˆØ§ÛŒ Ù‚Ø§Ø²Ø§Ù†Ø¬)</label>
                        <input type="text" id="froshtn" class="amount-input" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="nerxi-sud">Ù†Ø±Ø®ÛŒ Ù‚Ø§Ø²Ø§Ù†Ø¬ (%)</label>
                    <input type="text" id="nerxi-sud" readonly class="readonly">
                </div>

                <div class="form-group">
                    <label for="chenda-mang">Ø¨Û• Ú†Û•Ù†Ø¯ Ù…Ø§Ù†Ú¯</label>
                    <input type="number" id="chenda-mang" min="1" max="36" required>
                </div>

                <div class="form-group">
                    <label for="kafeel">Ú©Û•ÙÛŒÙ„</label>
                    <input type="text" id="kafeel">
                </div>

                <div class="form-group">
                    <label for="mobile-kafeel">Ù…Û†Ø¨Ø§ÛŒÙ„ÛŒ Ú©Û•ÙÛŒÙ„</label>
                    <input type="text" id="mobile-kafeel">
                </div>

                <div class="form-group">
                    <label for="froshyar">ÙØ±Û†Ø´ÛŒØ§Ø±</label>
                    <input type="text" id="froshyar">
                </div>

                <div class="form-group">
                    <label for="notes">ØªÛØ¨ÛŒÙ†ÛŒ (Ù†Û†Øª)</label>
                    <textarea id="notes" rows="3" placeholder="Ù‡Û•Ø± ØªÛØ¨ÛŒÙ†ÛÚ© Ú©Û• Ù¾ÛÙˆÛŒØ³ØªÛ•..."></textarea>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn-primary">ØªÛ†Ù…Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ù‚Û•Ø±Ø²</button>
                    <button type="reset" class="btn-secondary">Ù¾Ø§Ú©Ú©Ø±Ø¯Ù†Û•ÙˆÛ•</button>
                    <div id="loan-success" class="success-message">ØªÛ†Ù…Ø§Ø± Ú©Ø±Ø§</div>
                </div>
            </form>
        </div>

        <!-- ØªØ¨ ÙˆÛ•Ø±Ú¯Ø±ØªÙ†ÛŒ Ù‚ÛŒØ³Øª -->
        <div id="receive-installment" class="tab-content">
            <h2>ÙˆÛ•Ø±Ú¯Ø±ØªÙ†ÛŒ Ù‚ÛŒØ³Øª</h2>
            <!-- Ø¯Ú©Ù…Ù‡ PDF -->
<div class="pdf-btn-container">
    <button class="btn-pdf" onclick="generatePDF('receive-installment')">
        ğŸ“„ Ø¯Û•Ø±Ú©Ø±Ø¯Ù†ÛŒ PDF
    </button>
</div>
            <div class="installment-container">
                
                <div class="form-group">
                    <label for="select-waragr">Ù‡Û•ÚµØ¨Ú˜Ø§Ø±Ø¯Ù†ÛŒ ÙˆÛ•Ø±Ú¯Ø±</label>
                    <select id="select-waragr">
                        <option value="">Ù‡Û•ÚµØ¨Ú˜Ø§Ø±Ø¯Ù†ÛŒ ÙˆÛ•Ø±Ú¯Ø±</option>
                    </select>
                </div>

                <div id="loan-type-selection" style="display: none;">
                    <div class="form-group">
                        <label for="select-loan-type">Ù‡Û•ÚµØ¨Ú˜Ø§Ø±Ø¯Ù†ÛŒ Ø¬Û†Ø±ÛŒ Ù‚Û•Ø±Ø²</label>
                        <select id="select-loan-type">
                            <option value="">Ù‡Û•ÚµØ¨Ú˜Ø§Ø±Ø¯Ù†ÛŒ Ø¬Û†Ø±ÛŒ Ù‚Û•Ø±Ø²</option>
                        </select>
                    </div>
                </div>

                <form id="installment-form" class="form-container">
                    <div class="form-group">
                        <label for="installment-amount">Ù…Û•Ø¨Ù„Û•ØºÛŒ Ù‚ÛŒØ³Øª</label>
                        <input type="text" id="installment-amount" class="amount-input" required>
                    </div>

                    <div class="form-group">
                        <label for="installment-date">Ø¨Û•Ø±ÙˆØ§Ø±ÛŒ Ù‚ÛŒØ³Øª</label>
                        <input type="date" id="installment-date" required>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn-primary">ØªÛ†Ù…Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ù‚ÛŒØ³Øª</button>
                        <div id="installment-success" class="success-message">ØªÛ†Ù…Ø§Ø± Ú©Ø±Ø§</div>
                    </div>
                </form>

                <!-- Ú¯Ø²Ø§Ø±Ø´ Ú©Ø§Ù…Ù„ -->
                <div id="customer-report" class="report-section" style="display: none;">
                    <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ú¯Ø²Ø§Ø±Ø´ ØªÙˆØ³Ø· JavaScript Ù¾Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
                </div>
            </div>
        </div>

        <!-- ØªØ¨ Ø±Ø§Ù¾Û†Ø±ØªÛŒ ÙˆÛ•Ø±Ú¯Ø±Û•Ú©Ø§Ù† -->
        <div id="waragr-reports" class="tab-content">
            <h2>Ø±Ø§Ù¾Û†Ø±ØªÛŒ ÙˆÛ•Ø±Ú¯Ø±Û•Ú©Ø§Ù†</h2>
            <!-- Ø¯Ú©Ù…Ù‡ PDF -->
<div class="pdf-btn-container">
    <button class="btn-pdf" onclick="generatePDF('waragr-reports')">
        ğŸ“„ Ø¯Û•Ø±Ú©Ø±Ø¯Ù†ÛŒ PDF
    </button>
</div>
            <div class="form-container">
                <div class="form-group">
                    <label for="select-unique-waragr">Ù‡Û•ÚµØ¨Ú˜Ø§Ø±Ø¯Ù†ÛŒ ÙˆÛ•Ø±Ú¯Ø±</label>
                    <select id="select-unique-waragr">
                        <option value="">Ù‡Û•ÚµØ¨Ú˜Ø§Ø±Ø¯Ù†ÛŒ ÙˆÛ•Ø±Ú¯Ø±</option>
                    </select>
                </div>
                
                <div id="all-loans-report" class="report-section" style="display: none;">
                    <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ú¯Ø²Ø§Ø±Ø´ Ú©Ø§Ù…Ù„ ÙˆÛ•Ø±Ú¯Ø± -->
                </div>
            </div>
        </div>



        <!-- ØªØ¨ Ú¯Ø²Ø§Ø±Ø´Ø§Øª -->
        <div id="reports" class="tab-content">
            <div class="modern-dashboard">
                <div class="dashboard-header">
                    <h2>Ø¯Ø§Ø´Ø¨Û†Ø±Ø¯ÛŒ Ú¯Ø´ØªÛŒ</h2>
                    <p>Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛŒÛ•Ú©Ø§Ù†ÛŒ Ú©Û†ÛŒ Ø³ÛŒØ³ØªÛ•Ù…ÛŒ Ù‚Û•Ø±Ø²</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-icon">ğŸ’°</div>
                        <div class="stat-value" id="total-remaining">0</div>
                        <div class="stat-label">Ú©Û†ÛŒ Ù…Û•Ø¨Ù„Û•ØºÛŒ Ø¨Ø§Ù‚ÛŒÙ…Ø§Ù†Ø¯Û•ÛŒ Ù‚Û•Ø±Ø²Û•Ú©Ø§Ù†</div>
                    </div>

                    <!-- Ø¯Ø± stats-grid ÛŒÚ© Ú©Ø§Ø±Øª Ø¬Ø¯ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù† -->
<div class="stat-card" style="background: linear-gradient(135deg, #1abc9c, #16a085);">
    <div class="stat-icon">ğŸ¦</div>
    <div class="stat-value" id="fund-balance">0</div>
    <div class="stat-label">Ù¾Ø§Ø±Û•ÛŒ Ø¨Û•Ø±Ø¯Û•Ø³Øª (Ù‚Ø§ØµÛ•)</div>
</div>

<!-- Ú©Ø§Ø±Øª Ø¬Ø¯ÛŒØ¯ -->
    <div class="stat-card" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">
        <div class="stat-icon">ğŸ’³</div>
        <div class="stat-value" id="total-kreen">0</div>
        <div class="stat-label">Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ Ú©Ø±ÛŒÙ†</div>
    </div>
                    
                    <div class="stat-card success">
                        <div class="stat-icon">ğŸ“Š</div>
                        <div class="stat-value" id="total-received">0</div>
                        <div class="stat-label">Ú©Û†ÛŒ ÙˆÛ•Ø±Ú¯ÛŒØ±Ø§Ùˆ</div>
                    </div>
                    
                    <div class="stat-card warning">
                        <div class="stat-icon">ğŸ“ˆ</div>
                        <div class="stat-value" id="total-amount">0</div>
                        <div class="stat-label">Ú©Û†ÛŒ Ù…Û•Ø¨Ù„Û•ØºÛŒ Ù‚Û•Ø±Ø²Û•Ú©Ø§Ù†</div>
                    </div>
                    
                    <div class="stat-card info">
                        <div class="stat-icon">ğŸ“‹</div>
                        <div class="stat-value" id="total-loans">0</div>
                        <div class="stat-label">Ú©Û†ÛŒ Ù‚Û•Ø±Ø²Û•Ú©Ø§Ù†</div>
                    </div>
                </div>
            </div>

            <div class="charts-container">
                <div class="chart-card">
                    <h3>Ú•ÛÚ˜Û•ÛŒ ØªÛ•ÙˆØ§ÙˆØ¨ÙˆÙˆÙ†</h3>
                    <div class="progress-ring">
                        <svg width="120" height="120" viewBox="0 0 120 120">
                            <circle class="progress-bg" cx="60" cy="60" r="54"></circle>
                            <circle class="progress-fill" cx="60" cy="60" r="54" 
                                    stroke-dasharray="339.292" stroke-dashoffset="339.292"
                                    id="completion-ring"></circle>
                            <text class="progress-text" x="60" y="60" id="completion-text">0%</text>
                        </svg>
                    </div>
                    <div class="progress-label">Ú©Û†ÛŒ ÙˆÛ•Ø±Ú¯ÛŒØ±Ø§Ùˆ Ù„Û• Ú©Û†ÛŒ Ù‚Û•Ø±Ø²Û•Ú©Ø§Ù†</div>
                </div>
                
                <div class="chart-card">
                    <h3>Ø¯Ø§Ø¨Û•Ø´Ú©Ø§Ø±ÛŒ Ù‚Û•Ø±Ø²Û•Ú©Ø§Ù†</h3>
                    <div class="loan-distribution">
                        <div class="distribution-item">
                            <div class="distribution-color" style="background: #27ae60;"></div>
                            <div class="distribution-info">
                                <div class="distribution-value" id="active-loans">0</div>
                                <div class="distribution-label">Ù‚Û•Ø±Ø²Û• Ú†Ø§Ù„Ø§Ú©Û•Ú©Ø§Ù†</div>
                            </div>
                        </div>
                        <div class="distribution-item">
                            <div class="distribution-color" style="background: #e74c3c;"></div>
                            <div class="distribution-info">
                                <div class="distribution-value" id="completed-loans">0</div>
                                <div class="distribution-label">Ù‚Û•Ø±Ø²Û• ØªÛ•ÙˆØ§ÙˆÚ©Ø±Ø§ÙˆÛ•Ú©Ø§Ù†</div>
                            </div>
                        </div>
                        <div class="distribution-item">
                            <div class="distribution-color" style="background: #f39c12;"></div>
                            <div class="distribution-info">
                                <div class="distribution-value" id="total-profit">0</div>
                                <div class="distribution-label">Ú©Û†ÛŒ Ù‚Ø§Ø²Ø§Ù†Ø¬</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="info-cards">
                <div class="info-card">
                    <h4>Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛŒÛ•Ú©ÛŒ Ú¯Ø´ØªÛŒ</h4>
                    <div class="card-content">
                        <div class="card-item">
                            <label>ØªÛÚ©Ú•Ø§ÛŒ Ù…Û•Ø¨Ù„Û•ØºÛŒ Ù‚Û•Ø±Ø²:</label>
                            <span id="avg-loan-amount">0 Ø¯ÛŒÙ†Ø§Ø±</span>
                        </div>
                        <div class="card-item">
                            <label>ØªÛÚ©Ú•Ø§ÛŒ ÙˆÛ•Ø±Ú¯ÛŒØ±Ø§Ùˆ Ø¨Û† Ù‡Û•Ø± Ù‚Û•Ø±Ø²ÛÚ©:</label>
                            <span id="avg-received">0 Ø¯ÛŒÙ†Ø§Ø±</span>
                        </div>
                        <div class="card-item">
                            <label>ØªÛÚ©Ú•Ø§ÛŒ Ù…Ø§ÙˆÛ• Ø¨Û† Ù‡Û•Ø± Ù‚Û•Ø±Ø²ÛÚ©:</label>
                            <span id="avg-remaining">0 Ø¯ÛŒÙ†Ø§Ø±</span>
                        </div>
                    </div>
                </div>
                
                <div class="info-card">
                    <h4>Ú•ÛÚ˜Û•Ú©Ø§Ù†</h4>
                    <div class="card-content">
                        <div class="card-item">
                            <label>Ú•ÛÚ˜Û•ÛŒ Ù‚Û•Ø±Ø²Û• Ú†Ø§Ù„Ø§Ú©Û•Ú©Ø§Ù†:</label>
                            <span id="active-rate">0%</span>
                        </div>
                        <div class="card-item">
                            <label>Ú•ÛÚ˜Û•ÛŒ Ù‚Û•Ø±Ø²Û• ØªÛ•ÙˆØ§ÙˆÚ©Ø±Ø§ÙˆÛ•Ú©Ø§Ù†:</label>
                            <span id="completed-rate">0%</span>
                        </div>
                        <div class="card-item">
                            <label>Ú•ÛÚ˜Û•ÛŒ Ù‚Ø§Ø²Ø§Ù†Ø¬:</label>
                            <span id="profit-rate">0%</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="quick-actions">
                <button class="action-btn" onclick="openTab('new-loan')">
                    â• Ù‚Û•Ø±Ø²ÛŒ Ù†ÙˆÛ
                </button>
                <button class="action-btn success" onclick="openTab('receive-installment')">
                    ğŸ’° ÙˆÛ•Ø±Ú¯Ø±ØªÙ†ÛŒ Ù‚ÛŒØ³Øª
                </button>
                <button class="action-btn warning" onclick="openTab('waragr-reports')">
                    ğŸ“Š Ø±Ø§Ù¾Û†Ø±ØªÛŒ ÙˆÛ•Ø±Ú¯Ø±Û•Ú©Ø§Ù†
                </button>
            </div>
        </div>

    <!-- ØªØ¨ Ø®Ø§ÙˆÛ•Ù† Ù¾Ø´Ú©Û•Ú©Ø§Ù† -->
<div id="investors" class="tab-content">
    <h2>Ø®Ø§ÙˆÛ•Ù† Ù¾Ø´Ú©Û•Ú©Ø§Ù†</h2>
    <div id="investors-content">
        <p>Ø¨Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ Ø®Ø§ÙˆÛ•Ù† Ù¾Ø´Ú©Û•Ú©Ø§Ù†...</p>
    </div>
</div>

    <script>
        // ØªØ§Ø¨Ø¹ Ø§ØµÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ù„ÙˆØ¯ ØµÙØ­Ù‡
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ØµÙØ­Ù‡ Ù„ÙˆØ¯ Ø´Ø¯');
            initializeApp();
            setupEventListeners();
            loadWaragrList();
        });

        // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ø±Ù†Ø§Ù…Ù‡
        function initializeApp() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('beruar').value = today;
            document.getElementById('installment-date').value = today;
            console.log('Ø¯Ø§ØªØ§ Ø³Û•Ø±Û•ØªØ§ÛŒÛŒÛ•Ú©Ø§Ù† ÙˆÛ•Ø±Ú¯ÛŒØ±Ø§Ù†');
        }

      // ØªÙ†Ø¸ÛŒÙ… event listeners - Ù†Ø³Ø®Ù‡ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡
function setupEventListeners() {
    document.getElementById('loan-form').addEventListener('submit', handleNewLoan);
    document.getElementById('installment-form').addEventListener('submit', handleInstallment);
    document.getElementById('kreen').addEventListener('input', calculateSud);
    document.getElementById('froshtn').addEventListener('input', calculateSud);
    document.getElementById('select-waragr').addEventListener('change', handleWaragrSelection);
    document.getElementById('select-unique-waragr').addEventListener('change', loadAllLoansForWaragr);
    
    // Ø§ÛŒÙ† Ø®Ø· Ù…Ù‡Ù… Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†
    document.getElementById('select-loan-type').addEventListener('change', loadWaragrInfo);
    
    setupNumberFormatting();
    console.log('Event listeners Ø±ÛÚ© Ø®Ø±Ø§Ù†');
}

        // ÙØ±Ù…Øª Ú©Ø±Ø¯Ù† Ø§Ø¹Ø¯Ø§Ø¯ Ø¨Ù‡ ØµÙˆØ±Øª Ø³Ù‡ Ø±Ù‚Ù… Ø³Ù‡ Ø±Ù‚Ù…
        function setupNumberFormatting() {
            const amountInputs = document.querySelectorAll('.amount-input');
            amountInputs.forEach(input => {
                input.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/,/g, '');
                    if (!isNaN(value) && value !== '') {
                        e.target.value = Number(value).toLocaleString();
                    }
                });
            });
        }

        // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ø±ØµØ¯ Ø³ÙˆØ¯
        function calculateSud() {
            const kreen = document.getElementById('kreen');
            const froshtn = document.getElementById('froshtn');
            const nerxiSud = document.getElementById('nerxi-sud');
            
            const kreenValue = parseFloat(kreen.value.replace(/,/g, '')) || 0;
            const froshtnValue = parseFloat(froshtn.value.replace(/,/g, '')) || 0;
            
            if (kreenValue > 0 && froshtnValue > 0) {
                const sudPercentage = ((froshtnValue - kreenValue) / kreenValue * 100).toFixed(2);
                nerxiSud.value = sudPercentage + '%';
            } else {
                nerxiSud.value = '';
            }
        }

        // Ù„ÙˆØ¯ Ù„ÛŒØ³Øª ÙˆÛ•Ø±Ú¯Ø±Û•Ú©Ø§Ù† Ø¨Ø±Ø§ÛŒ ØªØ¨ ÙˆÛ•Ø±Ú¯Ø±ØªÙ†ÛŒ Ù‚ÛŒØ³Øª
        function loadWaragrList() {
            console.log('Ø¦Ø§Ù…Ø§Ø¯Û•Ú©Ø±Ø¯Ù†ÛŒ Ù†Ø§ÙˆÛŒ ÙˆÛ•Ø±Ú¯Ø±Û•Ú©Ø§Ù†...');
            const select = document.getElementById('select-waragr');
            select.innerHTML = '<option value="">Ù‡Û•ÚµØ¨Ú˜Ø§Ø±Ø¯Ù†ÛŒ ÙˆÛ•Ø±Ú¯Ø±</option>';
            
            google.script.run
                .withSuccessHandler(function(waragrList) {
                    console.log('Ù„ÛŒØ³ØªÛŒ ÙˆÛ•Ø±Ú¯Ø±Û•Ú©Ø§Ù† ÙˆÛ•Ø±Ú¯ÛŒØ±Ø§:', waragrList);
                    
                    waragrList.forEach(item => {
                        const option = document.createElement('option');
                        option.value = item.name;
                        option.textContent = `${item.name} - ${item.type} - ${Number(item.amount).toLocaleString()}`;
                        option.setAttribute('data-type', item.type);
                        select.appendChild(option);
                    });
                })
                .withFailureHandler(function(error) {
                    console.error('Ù‡Û•Ù„Û• Ù„Û• ÙˆÛ•Ø±Ú¯Ø±ØªÙ†ÛŒ ÙˆÛ•Ø±Ú¯Ø±Û•Ú©Ø§Ù†:', error);
                    showError('Ù‡Û•Ù„Û• Ù„Û• Ø¦Ø§Ù…Ø§Ø¯Û•Ú©Ø±Ø¯Ù†ÛŒ ÙˆÛ•Ø±Ú¯Ø±Û•Ú©Ø§Ù†: ' + error);
                })
                .getWaragrList();
        }

// Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ù†ØªØ®Ø§Ø¨ ÙˆÛ•Ø±Ú¯Ø± - Ù†Ø³Ø®Ù‡ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡
function handleWaragrSelection() {
    const waragrName = this.value;
    console.log('ÙˆÛ•Ø±Ú¯Ø± Ù‡Û•Ù„Ø¨Ú˜ÛØ±Ø¯Ø±Ø§:', waragrName);
    loadLoanTypesForWaragr(waragrName);
    
    // Ø§Ø¨ØªØ¯Ø§ Ú¯Ø²Ø§Ø±Ø´ Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†
    document.getElementById('customer-report').style.display = 'none';
    document.getElementById('customer-report').innerHTML = '';
}

// Ù„ÙˆØ¯ Ø§Ù†ÙˆØ§Ø¹ ÙˆØ§Ù… ÛŒÚ© ÙˆÛ•Ø±Ú¯Ø± - Ù†Ø³Ø®Ù‡ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡
function loadLoanTypesForWaragr(waragrName) {
    const typeSelect = document.getElementById('select-loan-type');
    const typeSelection = document.getElementById('loan-type-selection');
    
    if (!waragrName) {
        typeSelection.style.display = 'none';
        typeSelect.innerHTML = '<option value="">Ù‡Û•ÚµØ¨Ú˜Ø§Ø±Ø¯Ù†ÛŒ Ø¬Û†Ø±ÛŒ Ù‚Û•Ø±Ø²</option>';
        return;
    }
    
    typeSelect.innerHTML = '<option value="">Ù‡Û•ÚµØ¨Ú˜Ø§Ø±Ø¯Ù†ÛŒ Ø¬Û†Ø±ÛŒ Ù‚Û•Ø±Ø²</option>';
    
    google.script.run
        .withSuccessHandler(function(waragrList) {
            const types = waragrList.filter(item => item.name === waragrName);
            console.log('Ø¬Û†Ø±Û•Ú©Ø§Ù†ÛŒ Ù‚Û•Ø±Ø² Ø¨Û†', waragrName, ':', types);
            
            if (types.length > 1) {
                typeSelection.style.display = 'block';
                types.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item.type;
                    option.textContent = `${item.type} - ${Number(item.amount).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±`;
                    typeSelect.appendChild(option);
                });
                
                // Ø§Ú¯Ø± ÙÙ‚Ø· ÛŒÚ© Ø¬Û†Ø±ÛŒ Ù‚Û•Ø±Ø² Ø¯Ø§Ø±Ø¯ØŒ Ø¨Ù„Ø§ÙØ§ØµÙ„Ù‡ Ú¯Ø²Ø§Ø±Ø´ Ø±Ø§ Ù†Ø´Ø§Ù† Ø¨Ø¯Ù‡
                if (types.length === 1) {
                    typeSelect.value = types[0].type;
                    loadWaragrInfo();
                }
            } else {
                typeSelection.style.display = 'none';
                if (types.length === 1) {
                    typeSelect.value = types[0].type;
                    loadWaragrInfo();
                }
            }
        })
        .withFailureHandler(function(error) {
            console.error('Ù‡Û•Ù„Û• Ù„Û• ÙˆÛ•Ø±Ú¯Ø±ØªÙ†ÛŒ Ø¬Û†Ø±ÛŒ Ù‚Û•Ø±Ø²Û•Ú©Ø§Ù†:', error);
            typeSelection.style.display = 'none';
        })
        .getWaragrList();
}

// Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† event listener Ø¨Ø±Ø§ÛŒ ØªØºÛŒÛŒØ± Ø¬Û†Ø±ÛŒ Ù‚Û•Ø±Ø²
document.addEventListener('DOMContentLoaded', function() {
    // Ø§ÛŒÙ† Ø®Ø· Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†
    document.getElementById('select-loan-type').addEventListener('change', function() {
        console.log('Ø¬Û†Ø±ÛŒ Ù‚Û•Ø±Ø² Ú¯Û†Ø±Ø¯Ø±Ø§ Ø¨Û†:', this.value);
        loadWaragrInfo();
    });
});

// Ù„ÙˆØ¯ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙˆÛ•Ø±Ú¯Ø± Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡ - Ù†Ø³Ø®Ù‡ Ú©Ø§Ù…Ù„Ø§Ù‹ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡
function loadWaragrInfo() {
    const select = document.getElementById('select-waragr');
    const typeSelect = document.getElementById('select-loan-type');
    const customerReport = document.getElementById('customer-report');
    const waragrName = select.value;
    const loanType = typeSelect.value;
    
    console.log('Ù„Û†Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛ•Ú©Ø§Ù†ÛŒ - ÙˆÛ•Ø±Ú¯Ø±:', waragrName, 'Ø¬Û†Ø±ÛŒ Ù‚Û•Ø±Ø²:', loanType);
    
    if (!waragrName) {
        customerReport.style.display = 'none';
        customerReport.innerHTML = '';
        return;
    }
    
    // Ø§Ú¯Ø± Ú†Ù†Ø¯ ÙˆØ§Ù… Ø¯Ø§Ø±Ø¯ Ø§Ù…Ø§ Ø¬Û†Ø±ÛŒ Ù‚Û•Ø±Ø² Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø´Ø¯Ù‡ØŒ Ù…Ù†ØªØ¸Ø± Ø¨Ù…Ø§Ù†
    const typeSelection = document.getElementById('loan-type-selection');
    if (typeSelection.style.display === 'block' && !loanType) {
        customerReport.style.display = 'none';
        customerReport.innerHTML = '<div class="loading">Ø¬Û†Ø±ÛŒ Ù‚Û•Ø±Ø² Ù‡Û•Ù„Ø¨Ú˜ÛØ±Û•...</div>';
        return;
    }
    
    // Ù†Ù…Ø§ÛŒØ´ Ù„ÙˆØ¯ÛŒÙ†Ú¯
    customerReport.style.display = 'block';
    customerReport.innerHTML = '<div class="loading">Ø¦Ø§Ù…Ø§Ø¯Û•Ú©Ø±Ø¯Ù†ÛŒ Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛ•Ú©Ø§Ù†ÛŒ Ø¦Û•Ù… Ù‚Û•Ø±Ø²Û•...</div>';
    
    console.log('Ù†Ø§Ø±Ø¯Ù† Ø¨Û† Ø³ÛØ±Ú¤Û•Ø±:', { waragrName: waragrName, loanType: loanType });
    
    google.script.run
        .withSuccessHandler(function(customerData) {
            console.log('Ø¯Ø§ØªØ§Ú©Ø§Ù† ÙˆÛ•Ø±Ú¯ÛŒØ±Ø§Ù†:', customerData);
            displayCustomerReport(customerData);
        })
        .withFailureHandler(function(error) {
            console.error('Ù‡Û•Ù„Û•ÛŒÛ•Ú© Ù„Û• ÙˆÛ•Ø±Ú¯Ø±ØªÙ†ÛŒ Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛ•Ú©Ø§Ù†:', error);
            customerReport.innerHTML = `
                <div class="error-message">
                    Ù‡Û•Ù„Û• Ù„Û• Ø¦Ø§Ù…Ø§Ø¯Û•Ú©Ø±Ø¯Ù†ÛŒ Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛ•Ú©Ø§Ù†: ${error}
                    <br>
                    <button class="test-connection-btn" onclick="testConnection()">ØªÛØ³ØªÛŒ Ø³ÛØ±Ú¤Û•Ø±</button>
                </div>
            `;
        })
        .getWaragrInfo(waragrName, loanType);
}

        // Ù„ÙˆØ¯ Ù„ÛŒØ³Øª ÛŒÙˆÙ†ÛŒÚ© ÙˆÛ•Ø±Ú¯Ø±Û•Ú©Ø§Ù† Ø¨Ø±Ø§ÛŒ ØªØ¨ Ø±Ø§Ù¾Û†Ø±ØªÛŒ ÙˆÛ•Ø±Ú¯Ø±Û•Ú©Ø§Ù†
        function loadUniqueWaragrList() {
            console.log('Ø¦Ø§Ù…Ø§Ø¯Û•Ú©Ø±Ø¯Ù†ÛŒ Ù„ÛŒØ³ØªÛŒ ÛŒÙˆÙ†ÛŒÚ© Ø¨Û† ÙˆÛ•Ø±Ú¯Ø±Û•Ú©Ø§Ù†...');
            const select = document.getElementById('select-unique-waragr');
            select.innerHTML = '<option value="">Ù‡Û•ÚµØ¨Ú˜Ø§Ø±Ø¯Ù†ÛŒ ÙˆÛ•Ø±Ú¯Ø±</option>';
            
            google.script.run
                .withSuccessHandler(function(waragrList) {
                    console.log('Ù„ÛŒØ³ØªÛŒ ÛŒÙˆÙ†ÛŒÚ©ÛŒ ÙˆÛ•Ø±Ú¯Ø±Û•Ú©Ø§Ù† ÙˆÛ•Ø±Ú¯ÛŒØ±Ø§:', waragrList);
                    
                    waragrList.forEach(name => {
                        const option = document.createElement('option');
                        option.value = name;
                        option.textContent = name;
                        select.appendChild(option);
                    });
                })
                .withFailureHandler(function(error) {
                    console.error('Ù‡Û•Ù„Û• Ù„Û• Ù„ÛŒØ³ØªÛŒ ÛŒÙˆÙ†ÛŒÚ©ÛŒ ÙˆÛ•Ø±Ú¯Ø±Û•Ú©Ø§Ù†:', error);
                    showError('Ù‡Û•Ù„Û• Ù„Û• Ø¦Ø§Ù…Ø§Ø¯Û•Ú©Ø±Ø¯Ù†ÛŒ Ù„ÛŒØ³ØªÛŒ ÙˆÛ•Ø±Ú¯Ø±Û•Ú©Ø§Ù†: ' + error);
                })
                .getUniqueWaragrNames();
        }

        // Ù„ÙˆØ¯ ØªÙ…Ø§Ù… ÙˆØ§Ù…â€ŒÙ‡Ø§ÛŒ ÛŒÚ© ÙˆÛ•Ø±Ú¯Ø±
        function loadAllLoansForWaragr() {
            const select = document.getElementById('select-unique-waragr');
            const reportDiv = document.getElementById('all-loans-report');
            const waragrName = select.value;
            
            if (!waragrName) {
                reportDiv.style.display = 'none';
                return;
            }
            
            reportDiv.style.display = 'block';
            reportDiv.innerHTML = '<div class="loading">Ø¦Ø§Ù…Ø§Ø¯Û•Ú©Ø±Ø¯Ù†ÛŒ Ú¯Ø´Øª Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛ•Ú©Ø§Ù†ÛŒ ÙˆÛ•Ø±Ú¯Ø±...</div>';
            
            google.script.run
                .withSuccessHandler(function(data) {
                    displayAllLoansReport(data);
                })
                .withFailureHandler(function(error) {
                    console.error('Ù‡Û•Ù„Û• Ù„Û• Ø¦Ø§Ù…Ø§Ø¯Û•Ú©Ø±Ø¯Ù†ÛŒ Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ Ú¯Ø´Øª Ù‚Û•Ø±Ø²Û•Ú©Ø§Ù†:', error);
                    reportDiv.innerHTML = `
                        <div class="error-message">
                            Ù‡Û•Ù„Û• Ù„Û• Ø¦Ø§Ù…Ø§Ø¯Û•Ú©Ø±Ø¯Ù†ÛŒ Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛ•Ú©Ø§Ù†: ${error}
                        </div>
                    `;
                })
                .getAllLoansForWaragr(waragrName);
        }

    function displayCustomerReport(data) {
    const customerReport = document.getElementById('customer-report');
    
    if (data.error) {
        customerReport.innerHTML = `
            <div class="error-message">
                ${data.error}
            </div>
        `;
        return;
    }
    
    const html = `
        <div class="excel-style-report">
            <div class="excel-header">
                <h3>Ú•Ø§Ù¾Û†Ø±ØªÛŒ ÙˆÛ•Ø±Ú¯Ø± - ${data.waragrName}</h3>
            </div>
            
            <div class="excel-subheader">
                <strong>Ø¬Û†Ø±ÛŒ Ù‚Û•Ø±Ø²:</strong> ${data.loanType}
            </div>

            <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ú©Ø³Ù„ÛŒ -->
            <table class="excel-table">
                <thead>
                    <tr>
                        <th>Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ</th>
                        <th>Ø¨Ú•</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Ú©Û†ÛŒ Ù…Û•Ø¨Ù„Û•ØºÛŒ Ù‚Û•Ø±Ø²</strong></td>
                        <td class="amount">${Number(data.totalAmount).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</td>
                    </tr>
                    <tr>
                        <td><strong>Ú©Û†ÛŒ ÙˆÛ•Ø±Ú¯ÛŒØ±Ø§Ùˆ</strong></td>
                        <td class="paid">${Number(data.totalPaid).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</td>
                    </tr>
                    <tr>
                        <td><strong>Ù…Û•Ø¨Ù„Û•ØºÛŒ Ù…Ø§ÙˆÛ•</strong></td>
                        <td class="remaining">${Number(data.remainingAmount).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</td>
                    </tr>
                    <tr>
                        <td><strong>Ù‚ÛŒØ³ØªÛŒ Ù…Ø§Ù†Ú¯Ø§Ù†Û•</strong></td>
                        <td>${Number(data.monthlyPayment).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</td>
                    </tr>
                    <tr>
                        <td><strong>Ù‚ÛŒØ³ØªÛ• ÙˆÛ•Ø±Ú¯ÛŒØ±Ø§ÙˆÛ•Ú©Ø§Ù†</strong></td>
                        <td>${data.paidInstallments} Ù‚ÛŒØ³Øª</td>
                    </tr>
                    <tr>
                        <td><strong>Ø¨Û•Ú†Û•Ù†Ø¯ Ù…Ø§Ù†Ú¯</strong></td>
                        <td>${data.months} Ù…Ø§Ù†Ú¯</td>
                    </tr>
                    ${data.mobileWaragr ? `
                    <tr>
                        <td><strong>Ù…Û†Ø¨Ø§ÛŒÙ„ÛŒ ÙˆÛ•Ø±Ú¯Ø±</strong></td>
                        <td>${data.mobileWaragr}</td>
                    </tr>
                    ` : ''}
                    <tr>
                        <td><strong>Ú©Û•ÙÛŒÙ„</strong></td>
                        <td>${data.kafeel || '---'}</td>
                    </tr>
                    <tr>
                        <td><strong>Ø¨Û•Ø±ÙˆØ§Ø±ÛŒ ÙˆÛ•Ø±Ú¯Ø±ØªÙ†</strong></td>
                        <td>${data.loanDate}</td>
                    </tr>
                </tbody>
            </table>

            <!-- Ø¬Ø¯ÙˆÙ„ ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ù‚ÛŒØ³Øªâ€ŒÙ‡Ø§ -->
            ${data.installmentHistory && data.installmentHistory.length > 0 ? `
            <div style="margin-top: 30px;">
                <h4 style="text-align: center; color: #2c3e50; margin-bottom: 15px;">Ù…ÛÚ˜ÙˆÙˆÛŒ Ù‚ÛŒØ³ØªÛ• ÙˆÛ•Ø±Ú¯ÛŒØ±Ø§ÙˆÛ•Ú©Ø§Ù†</h4>
                <table class="excel-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Ù‚ÛŒØ³Øª</th>
                            <th>Ù…Û•Ø¨Ù„Û•Øº</th>
                            <th>Ø¨Û•Ø±ÙˆØ§Ø±</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${data.installmentHistory.map(installment => `
                            <tr>
                                <td>${installment.number}</td>
                                <td>Ù‚ÛŒØ³ØªÛŒ ${installment.number} </td>
                                <td class="amount">${Number(installment.amount).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</td>
                                <td>${installment.date}</td>
                            </tr>
                        `).join('')}
                        <tr class="total-row">
                            <td colspan="2"><strong>Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ</strong></td>
                            <td class="amount"><strong>${Number(data.totalPaid).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</strong></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            ` : '<div style="text-align: center; color: #7f8c8d; padding: 20px; background: #f8f9fa; border-radius: 6px; margin-top: 20px;">Ù‡ÛŒÚ† Ù‚ÛŒØ³ØªÛÚ© ØªÛ†Ù…Ø§Ø± Ù†Û•Ú©Ø±Ø§ÙˆÛ•</div>'}
        </div>
    `;
    
    customerReport.innerHTML = html;
    customerReport.style.display = 'block';
}


        // Ù†Ù…Ø§ÛŒØ´ Ú¯Ø²Ø§Ø±Ø´ Ú©Ø§Ù…Ù„ ØªÙ…Ø§Ù… ÙˆØ§Ù…â€ŒÙ‡Ø§ÛŒ ÛŒÚ© ÙˆÛ•Ø±Ú¯Ø±
function displayAllLoansReport(data) {
    const reportDiv = document.getElementById('all-loans-report');
    
    if (data.error) {
        reportDiv.innerHTML = `
            <div class="error-message">
                ${data.error}
            </div>
        `;
        return;
    }
    
    let loansHTML = '';
    
    data.loans.forEach((loan, index) => {
        loansHTML += `
            <div style="margin-bottom: 40px;">
                <table class="excel-table keep-together">
                    <thead>
                        <tr class="loan-header">
                            <th colspan="2">Ù‚Û•Ø±Ø²ÛŒ ${index + 1} - ${loan.loanType}</th>
                        </tr>
                        <tr>
                            <th>Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ</th>
                            <th>Ø¨Ú•</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Ú©Û†ÛŒ Ù…Û•Ø¨Ù„Û•ØºÛŒ Ù‚Û•Ø±Ø²</strong></td>
                            <td class="amount">${Number(loan.totalAmount).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</td>
                        </tr>
                        <tr>
                            <td><strong>Ú©Û†ÛŒ ÙˆÛ•Ø±Ú¯ÛŒØ±Ø§Ùˆ</strong></td>
                            <td class="paid">${Number(loan.totalPaid).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</td>
                        </tr>
                        <tr>
                            <td><strong>Ù…Û•Ø¨Ù„Û•ØºÛŒ Ù…Ø§ÙˆÛ•</strong></td>
                            <td class="remaining">${Number(loan.remainingAmount).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</td>
                        </tr>
                        <tr>
                            <td><strong>Ù‚ÛŒØ³ØªÛŒ Ù…Ø§Ù†Ú¯Ø§Ù†Û•</strong></td>
                            <td>${Number(loan.monthlyPayment).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</td>
                        </tr>
                        <tr>
                            <td><strong>Ù‚ÛŒØ³ØªÛ• ÙˆÛ•Ø±Ú¯ÛŒØ±Ø§ÙˆÛ•Ú©Ø§Ù†</strong></td>
                            <td>${loan.paidInstallments} Ù‚ÛŒØ³Øª</td>
                        </tr>
                        <tr>
                            <td><strong>Ø¨Û•Ú†Û•Ù†Ø¯ Ù…Ø§Ù†Ú¯</strong></td>
                            <td>${loan.months} Ù…Ø§Ù†Ú¯</td>
                        </tr>
                        <tr>
                            <td><strong>Ø¨Û•Ø±ÙˆØ§Ø±ÛŒ ÙˆÛ•Ø±Ú¯Ø±ØªÙ†</strong></td>
                            <td>${loan.loanDate}</td>
                        </tr>
                    </tbody>
                </table>

                ${loan.installmentHistory.length > 0 ? `
                <div style="margin-top: 20px;">
                    <table class="excel-table keep-together">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ù‚ÛŒØ³Øª</th>
                                <th>Ù…Û•Ø¨Ù„Û•Øº</th>
                                <th>Ø¨Û•Ø±ÙˆØ§Ø±</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${loan.installmentHistory.map(installment => `
                                <tr>
                                    <td>${installment.number}</td>
                                    <td>Ù‚ÛŒØ³ØªÛŒ ${installment.number} </td>
                                    <td class="amount">${Number(installment.amount).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</td>
                                    <td>${installment.date}</td>
                                </tr>
                            `).join('')}
                            <tr class="total-row">
                                <td colspan="2"><strong>Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ</strong></td>
                                <td class="amount"><strong>${Number(loan.totalPaid).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</strong></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                ` : ''}
            </div>
        `;
    });
    
    const html = `
        <div class="excel-style-report">
            <div class="excel-header">
                <h3>Ú•Ø§Ù¾Û†Ø±ØªÛŒ ØªÛ•ÙˆØ§Ùˆ - ${data.waragrName}</h3>
            </div>
            
            <div class="excel-subheader">
                <strong>Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ Ù‡Û•Ù…ÙˆÙˆ Ù‚Û•Ø±Ø²Û•Ú©Ø§Ù†</strong>
            </div>

            <!-- Ø¬Ø¯ÙˆÙ„ Ø®Ù„Ø§ØµÙ‡ Ú©Ù„ -->
            <table class="excel-table keep-together">
                <thead>
                    <tr>
                        <th>Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ</th>
                        <th>Ø¨Ú•</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Ú©Û†ÛŒ Ù‚Û•Ø±Ø²Û•Ú©Ø§Ù†</strong></td>
                        <td>${data.totalLoans} Ù‚Û•Ø±Ø²</td>
                    </tr>
                    <tr>
                        <td><strong>Ú©Û†ÛŒ Ù…Û•Ø¨Ù„Û•ØºÛŒ Ù‚Û•Ø±Ø²Û•Ú©Ø§Ù†</strong></td>
                        <td class="amount">${Number(data.totalAllLoans).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</td>
                    </tr>
                    <tr>
                        <td><strong>Ú©Û†ÛŒ ÙˆÛ•Ø±Ú¯ÛŒØ±Ø§Ùˆ</strong></td>
                        <td class="paid">${Number(data.totalAllPaid).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</td>
                    </tr>
                    <tr>
                        <td><strong>Ú©Û†ÛŒ Ù…Ø§ÙˆÛ•</strong></td>
                        <td class="remaining">${Number(data.totalAllRemaining).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</td>
                    </tr>
                    
                </tbody>
            </table>
            
            <div style="margin-top: 40px;">
                <h3 style="text-align: center; color: #2c3e50; margin-bottom: 20px;">Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛŒÛ•Ú©Ø§Ù†ÛŒ Ù‡Û•Ø± Ù‚Û•Ø±Ø²ÛÚ©</h3>
                ${loansHTML}
            </div>
        </div>
    `;
    
    reportDiv.innerHTML = html;
    reportDiv.style.display = 'block';
}

        // Ù„ÙˆØ¯ Ú¯Ø²Ø§Ø±Ø´Ø§Øª Ø³ÛŒØ³ØªÙ…
        function loadSystemReports() {
            google.script.run
                .withSuccessHandler(function(data) {
                    displaySystemReports(data);
                })
                .withFailureHandler(function(error) {
                    console.error('Ù‡Û•Ù„Û• Ù„Û• ÙˆÛ•Ø±Ú¯Ø±ØªÙ†ÛŒ Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ Ù„Û• Ø³ÛŒØ³ØªÛ•Ù…:', error);
                    document.getElementById('reports').innerHTML = `
                        <div class="error-message">
                            Ù‡Û•Ù„Û• Ù„Û• Ø¦Ø§Ù…Ø§Ø¯Û•Ú©Ø±Ø¯Ù†ÛŒ Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ Ù„Û• Ø³ÛŒØ³ØªÛ•Ù…: ${error}
                        </div>
                    `;
                })
                .getSystemReports();
        }

        // Ù†Ù…Ø§ÛŒØ´ Ú¯Ø²Ø§Ø±Ø´Ø§Øª Ø³ÛŒØ³ØªÙ…
        function displaySystemReports(data) {
            if (data.error) {
                document.getElementById('reports').innerHTML = `
                    <div class="error-message">
                        ${data.error}
                    </div>
                `;
                return;
            }
            
            // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§
            document.getElementById('total-remaining').textContent = Number(data.totalRemaining).toLocaleString();
            document.getElementById('total-received').textContent = Number(data.totalReceived).toLocaleString();
            document.getElementById('total-amount').textContent = Number(data.totalAmount).toLocaleString();
            document.getElementById('total-loans').textContent = data.totalLoans;
            document.getElementById('active-loans').textContent = data.activeLoans;
            document.getElementById('completed-loans').textContent = data.completedLoans;
            document.getElementById('total-profit').textContent = Number(data.totalProfit).toLocaleString();
            document.getElementById('fund-balance').textContent = Number(data.fundBalance).toLocaleString();
            document.getElementById('total-kreen').textContent = Number(data.totalKreen).toLocaleString();
            
            // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…ÙˆØ¯Ø§Ø± Ø¯Ø§ÛŒØ±Ù‡â€ŒØ§ÛŒ
            const completionRate = data.completionRate;
            const ring = document.getElementById('completion-ring');
            const text = document.getElementById('completion-text');
            const circumference = 339.292;
            const offset = circumference - (completionRate / 100) * circumference;
            
            ring.style.strokeDashoffset = offset;
            text.textContent = completionRate + '%';
            
            // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø¶Ø§ÙÛŒ
            document.getElementById('avg-loan-amount').textContent = 
                data.totalLoans > 0 ? Number(data.totalAmount / data.totalLoans).toLocaleString() + ' Ø¯ÛŒÙ†Ø§Ø±' : '0 Ø¯ÛŒÙ†Ø§Ø±';
            
            document.getElementById('avg-received').textContent = 
                data.totalLoans > 0 ? Number(data.totalReceived / data.totalLoans).toLocaleString() + ' Ø¯ÛŒÙ†Ø§Ø±' : '0 Ø¯ÛŒÙ†Ø§Ø±';
            
            document.getElementById('avg-remaining').textContent = 
                data.totalLoans > 0 ? Number(data.totalRemaining / data.totalLoans).toLocaleString() + ' Ø¯ÛŒÙ†Ø§Ø±' : '0 Ø¯ÛŒÙ†Ø§Ø±';
            
            document.getElementById('active-rate').textContent = 
                data.totalLoans > 0 ? Math.round((data.activeLoans / data.totalLoans) * 100) + '%' : '0%';
            
            document.getElementById('completed-rate').textContent = 
                data.totalLoans > 0 ? Math.round((data.completedLoans / data.totalLoans) * 100) + '%' : '0%';
            
            document.getElementById('profit-rate').textContent = 
                data.totalAmount > 0 ? Math.round((data.totalProfit / data.totalAmount) * 100) + '%' : '0%';
        }

        // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªÙ…Ø§Ù… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
        function updateAllData() {
            if (confirm('Ø¦Ø§ÛŒØ§ Ø¯ÚµÙ†ÛŒØ§ÛŒ Ú©Û• Ø¯Û•ØªÛ•ÙˆÛØª Ù‡Û•Ù…ÙˆÙˆ Ø¯Ø§ØªØ§Ú©Ø§Ù† Ù†ÙˆÛ Ø¨Ú©Û•ÛŒØªÛ•ÙˆÛ•ØŸ\nØ¦Û•Ù… Ú©Ø§Ø±Û• Ú•ÛÚ©Ø®Ø³ØªÙ†Û•Ú©Ø§Ù†ÛŒ Ú©Û†ÛŒ AH Ùˆ AI Ù†ÙˆÛ Ø¯Û•Ú©Ø§ØªÛ•ÙˆÛ•.')) {
                const loadingText = 'Ù†ÙˆÛÚ©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒ Ú¯Ø´Øª Ø¯Ø§ØªØ§Ú©Ø§Ù†...';
                showTempMessage(loadingText);
                
                google.script.run
                    .withSuccessHandler(function(result) {
                        if (result.success) {
                            showTempMessage('âœ… ' + result.message, 'success');
                            // Ø±ÛŒÙ„ÙˆØ¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                            setTimeout(() => {
                                if (document.getElementById('receive-installment').classList.contains('active')) {
                                    loadWaragrList();
                                }
                                if (document.getElementById('investors').classList.contains('active')) {
                                    loadInvestorsData();
                                }
                                if (document.getElementById('reports').classList.contains('active')) {
                                    loadSystemReports();
                                }
                            }, 2000);
                        } else {
                            showTempMessage('âŒ ' + result.message, 'error');
                        }
                    })
                    .withFailureHandler(function(error) {
                        console.error('Ù‡Û•Ù„Û• Ù„Û• Ù†ÙˆÛÚ©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒ Ø¯Ø§ØªØ§Ú©Ø§Ù†:', error);
                        showTempMessage('âŒ Ù‡Û•Ù„Û• Ù„Û• Ù†ÙˆÛÚ©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒ Ø¯Ø§ØªØ§Ú©Ø§Ù†: ' + error, 'error');
                    })
                    .updateAllData();
            }
        }

        // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ù…ÙˆÙ‚Øª
        function showTempMessage(message, type = 'info') {
            const messageDiv = document.createElement('div');
            messageDiv.textContent = message;
            messageDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 5px;
                color: white;
                font-weight: bold;
                z-index: 1000;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                ${type === 'success' ? 'background: #27ae60;' : ''}
                ${type === 'error' ? 'background: #e74c3c;' : ''}
                ${type === 'info' ? 'background: #3498db;' : ''}
            `;
            
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 5000);
        }

        // ØªØ³Øª Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±
        function testConnection() {
            console.log('ØªÛØ³ØªÛŒ Ù„ÛŒÙ†Ú©ÛŒ Ø³ÛØ±Ú¤Û•Ø±...');
            google.script.run
                .withSuccessHandler(function(result) {
                    console.log('Ø¦Û•Ù†Ø¬Ø§Ù…:', result);
                    alert('Ù¾Û•ÙˆÛŒÙˆÛ•Ù†Ø¯ÛŒ Ø³Û•Ø±Ú©Û•ÙˆØªÙˆÙˆ Ø¨ÙˆÙˆ: ' + result.message);
                })
                .withFailureHandler(function(error) {
                    console.error('Ù‡Û•Ù„Û• Ù„Û• Ù¾Û•ÛŒÙˆÛ•Ù†Ø¯ÛŒÚ©Ø±Ø¯Ù†:', error);
                    alert('Ù‡Û•Ù„Û• Ù„Û• Ù¾Û•ÛŒÙˆÛ•Ù†Ø¯ÛŒÚ©Ø±Ø¯Ù† Ø¨Û• Ø³ÛØ±Ú¤Û•Ø±: ' + error);
                })
                .testConnection();
        }

        // Ù…Ø¯ÛŒØ±ÛŒØª Ø«Ø¨Øª Ù‚Û•Ø±Ø² Ø¬Ø¯ÛŒØ¯
        function handleNewLoan(e) {
            e.preventDefault();
            console.log('ØªÛ†Ù…Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ù‚ÛŒØ³ØªÛŒ Ù†ÙˆÛ...');
            
            const formData = getLoanFormData();
            console.log('Ø¯Ø§ØªØ§Ú©Ø§Ù†ÛŒ ÙÛ†Ø±Ù…:', formData);
            
            if (!formData.waragr || !formData.kreen || !formData.froshtn || !formData.chendaMang) {
                alert('ØªÚ©Ø§ÛŒÛ• Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛ• Ù¾ÛÙˆÛŒØ³ØªÛ•Ú©Ø§Ù† Ø¨Ù†ÙˆÙˆØ³Û•');
                return;
            }
            
            const successMessage = document.getElementById('loan-success');
            successMessage.style.display = 'block';
            successMessage.textContent = 'ØªÛ†Ù…Ø§Ø±Ú©Ø±Ø¯Ù†...';
            
            google.script.run
                .withSuccessHandler(function(result) {
                    console.log('Ù‚ÛŒØ³Øª ØªÛ†Ù…Ø§Ø±Ú©Ø±Ø§:', result);
                    successMessage.textContent = 'Ù‚Û•Ø±Ø² Ø¨Û• Ø³Û•Ø±Ú©Û•ÙˆØªÙˆÙˆÛŒÛŒ ØªÛ†Ù…Ø§Ø± Ú©Ø±Ø§';
                    
                    setTimeout(() => {
                        successMessage.style.display = 'none';
                    }, 3000);
                    
                    document.getElementById('loan-form').reset();
                    calculateSud();
                    loadWaragrList();
                })
                .withFailureHandler(function(error) {
                    console.error('Ù‡Û•Ù„Û• Ù„Û• ØªÛ†Ù…Ø§Ø±ÛŒ Ù‚Û•Ø±Ø²:', error);
                    successMessage.style.display = 'none';
                    alert('Ù‡Û•ÚµÛ• Ù„Û• ØªÛ†Ù…Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ù‚Û•Ø±Ø²: ' + error);
                })
                .saveNewLoan(formData);
        }

        // Ù…Ø¯ÛŒØ±ÛŒØª Ø«Ø¨Øª Ù‚ÛŒØ³Øª
        function handleInstallment(e) {
            e.preventDefault();
            console.log('ØªÛ†Ù…Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ù‚ÛŒØ³Øª...');
            
            const formData = getInstallmentFormData();
            console.log('Ø¯Ø§ØªØ§Ú©Ø§Ù†ÛŒ Ù‚ÛŒØ³Øª:', formData);
            
            if (!formData.waragr) {
                alert('ØªÚ©Ø§ÛŒÛ• ÙˆÛ•Ø±Ú¯Ø± Ù‡Û•ÚµØ¨Ú˜ÛØ±Û•');
                return;
            }
            
            if (!formData.amount || formData.amount === '0') {
                alert('ØªÚ©Ø§ÛŒÛ• Ù…Û•Ø¨Ù„Û•ØºÛŒ Ù‚ÛŒØ³Øª Ø¨Ù†ÙˆÙˆØ³Û•');
                return;
            }
            
            const successMessage = document.getElementById('installment-success');
            successMessage.style.display = 'block';
            successMessage.textContent = 'ØªÛ†Ù…Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ù‚ÛŒØ³Øª...';
            
            google.script.run
                .withSuccessHandler(function(result) {
                    console.log('Ù‚ÛŒØ³Øª ØªÛ†Ù…Ø§Ø±Ú©Ø±Ø§:', result);
                    
                    successMessage.textContent = `Ù‚ÛŒØ³ØªÛŒ ${result.installmentNumber}  Ø¨Û• Ø³Û•Ø±Ú©Û•ÙˆØªÙˆÙˆÛŒÛŒ ØªÛ†Ù…Ø§Ø± Ú©Ø±Ø§`;
                    
                    document.getElementById('installment-amount').value = '';
                    loadWaragrInfo();
                    
                    setTimeout(() => {
                        successMessage.style.display = 'none';
                    }, 3000);
                    
                })
                .withFailureHandler(function(error) {
                    console.error('Ù‡Û•Ù„Û• Ù„Û• ØªÛ†Ù…Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ù‚ÛŒØ³Øª:', error);
                    successMessage.style.display = 'none';
                    alert('Ù‡Û•ÚµÛ• Ù„Û• ØªÛ†Ù…Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ù‚ÛŒØ³Øª: ' + error);
                })
                .saveInstallment(formData);
        }

        // Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÙØ±Ù… Ù‚Û•Ø±Ø²
        function getLoanFormData() {
            return {
                waragr: document.getElementById('waragr').value,
                mobileWaragr: document.getElementById('mobile-waragr').value,
                jorQist: document.getElementById('jor-qist').value,
                beruar: document.getElementById('beruar').value,
                kreen: document.getElementById('kreen').value.replace(/,/g, '') || '0',
                froshtn: document.getElementById('froshtn').value.replace(/,/g, '') || '0',
                nerxiSud: document.getElementById('nerxi-sud').value.replace('%', '') || '0',
                chendaMang: document.getElementById('chenda-mang').value || '0',
                kafeel: document.getElementById('kafeel').value,
                mobileKafeel: document.getElementById('mobile-kafeel').value,
                froshyar: document.getElementById('froshyar').value,
                notes: document.getElementById('notes').value
            };
        }

        // Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÙØ±Ù… Ù‚ÛŒØ³Øª
        function getInstallmentFormData() {
            const loanType = document.getElementById('select-loan-type').value;
            const waragrName = document.getElementById('select-waragr').value;
            
            return {
                waragr: waragrName,
                loanType: loanType,
                amount: document.getElementById('installment-amount').value.replace(/,/g, '') || '0',
                date: document.getElementById('installment-date').value
            };
        }

        // ØªØ§Ø¨Ø¹ ØªØºÛŒÛŒØ± ØªØ¨â€ŒÙ‡Ø§
        function openTab(tabName) {
            console.log('Ú¯Û†Ø±ÛŒÙ†ÛŒ Ù„Ø§Ù¾Û•Ø±Û• Ø¨Û†:', tabName);
            
            const tabContents = document.getElementsByClassName('tab-content');
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove('active');
            }
            
            const tabButtons = document.getElementsByClassName('tab-button');
            for (let i = 0; i < tabButtons.length; i++) {
                tabButtons[i].classList.remove('active');
            }
            
            document.getElementById(tabName).classList.add('active');
            event.currentTarget.classList.add('active');
            
            if (tabName === 'receive-installment') {
                loadWaragrList();
                document.getElementById('customer-report').style.display = 'none';
                document.getElementById('loan-type-selection').style.display = 'none';
            } else if (tabName === 'waragr-reports') {
                loadUniqueWaragrList();
                document.getElementById('all-loans-report').style.display = 'none';
            } else if (tabName === 'reports') {
                loadSystemReports();
            } else if (tabName === 'investors') {
                loadInvestorsData();
            }
        }

       // Ù„ÙˆØ¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±Ø§Ù† - Ù†Ø³Ø®Ù‡ Ú©Ø§Ù…Ù„ Ø¨Ø§ Ø³ÙˆØ¯ ÙˆØ§Ù‚Ø¹ÛŒ
function loadInvestorsData() {
    console.log('Ø¦Ø§Ù…Ø§Ø¯Û•Ú©Ø±Ø¯Ù†ÛŒ Ø¯Ø§ØªØ§ÛŒ Ø®Ø§ÙˆÛ•Ù† Ù¾Ø´Ú©Û•Ú©Ø§Ù†...');
    const investorsContent = document.getElementById('investors-content');
    investorsContent.innerHTML = '<div class="loading">Ø¦Ø§Ù…Ø§Ø¯Û•Ú©Ø±Ø¯Ù†...</div>';
    
    google.script.run
        .withSuccessHandler(function(result) {
            console.log('Ø¯Ø§ØªØ§ÛŒ Ø®Ø§ÙˆÛ•Ù† Ù¾Ø´Ú©Û•Ú©Ø§Ù† ÙˆÛ•Ø±Ú¯ÛŒØ±Ø§:', result);
            
            if (result.success) {
                let html = '';
                
                // Ø¬Ø¯ÙˆÙ„ Ø®Ø§ÙˆÛ•Ù† Ù¾Ø´Ú©Û•Ú©Ø§Ù† (Ø³ÙˆØ¯ Ø¨Ø§Ù„Ù‚ÙˆÙ‡)
                if (result.investorsData && result.investorsData.length > 0) {
                    html += `
                        <h3>Ø®Ø§ÙˆÛ•Ù† Ù¾Ø´Ú©Û•Ú©Ø§Ù† - Ù‚Ø§Ø²Ø§Ù†Ø¬ÛŒ Ú©Û†ØªØ§ÛŒÛŒ</h3>
                        <p style="color: #666; margin-bottom: 15px; font-size: 16px;">
                            Ø¦Û•Ú¯Û•Ø± Ú¯Ø´Øª Ù‚ÛŒØ³ØªÛ•Ú©Ø§Ù† Ø¯Ø±Ø§Ø¨Ù† Ù‚Ø§Ø²Ø§Ù†Ø¬Û•Ú©Ø§Ù† Ø¨Û•Ù… Ø´ÛÙˆØ§Ø²Û• Ø¯Û•Ø¨ÛŒØª
                        </p>
                        <table class="investors-table">
                            <thead>
                                <tr>
                                    <th>Ù†Ø§Ùˆ</th>
                                    <th>Ù…Û•Ø¨Ù„Û•ØºÛŒ Ø³Û•Ø±Ù…Ø§ÛŒÛ•</th>
                                    <th>Ú•ÛÚ˜Û•ÛŒ Ø³Û•Ø±Ù…Ø§ÛŒÛ•</th>
                                    <th>Ú•ÛÚ˜Û•ÛŒ Ù‚Ø§Ø²Ø§Ù†Ø¬</th>
                                    <th>Ù‚Ø§Ø²Ø§Ù†Ø¬ÛŒ Ú©Û†ØªØ§ÛŒÛŒ</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    
                    result.investorsData.forEach(investor => {
                        html += `
                            <tr>
                                <td>${investor.name}</td>
                                <td>${Number(investor.investment).toLocaleString()}</td>
                                <td>${investor.percentage}%</td>
                                <td>${investor.profitPercentage}%</td>
                                <td>${Number(investor.profitAmount).toLocaleString()}</td>
                            </tr>
                        `;
                    });
                    
                    html += `</tbody></table>`;
                } else {
                    html += `<p>Ù‡ÛŒÚ† Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛ•Ú©ÛŒ Ø®Ø§ÙˆÛ•Ù† Ù¾Ø´Ú©Û•Ú©Ø§Ù† Ù†ÛŒÛ•</p>`;
                }
                
                // Ø¬Ø¯ÙˆÙ„ Ø¬Ø¯ÛŒØ¯: Ø³ÙˆØ¯ ÙˆØ§Ù‚Ø¹ÛŒ
                if (result.actualProfitData && result.actualProfitData.investorsActualProfitData.length > 0) {
    html += `
        <h3 style="margin-top: 40px;">Ù‚Ø§Ø²Ø§Ù†Ø¬ÛŒ Ø±Ø§Ø³ØªÛ•Ù‚ÛŒÙ†Û• ØªØ§ Ø¦Û•Ù… Ø³Ø§ØªÛ•</h3>
        <p style="color: #666; margin-bottom: 15px; font-size: 16px;">
            Ù‚Ø§Ø²Ø§Ù†Ø¬ÛŒ Ø¦Û•Ùˆ Ù‚ÛŒØ³ØªØ§Ù†Û•ÛŒ ØªØ§ Ø¦ÛØ³ØªØ§ Ø¯Ø±Ø§ÙˆÙ†
        </p>
        <table class="investors-table">
            <thead>
                <tr>
                    <th>Ù†Ø§Ùˆ</th>
                    <th>Ù…Û•Ø¨Ù„Û•ØºÛŒ Ø³Û•Ø±Ù…Ø§ÛŒÛ•</th>
                    <th>Ú•ÛÚ˜Û•ÛŒ Ø³Û•Ø±Ù…Ø§ÛŒÛ•</th>
                    <th>Ú•ÛÚ˜Û•ÛŒ Ù‚Ø§Ø²Ø§Ù†Ø¬</th>
                    <th>Ù‚Ø§Ø²Ø§Ù†Ø¬ÛŒ Ø±Ø§Ø³ØªÛ•Ù‚ÛŒÙ†Û•</th>
                </tr>
            </thead>
            <tbody>
    `;
    
    result.actualProfitData.investorsActualProfitData.forEach(investor => {
        html += `
            <tr>
                <td>${investor.name}</td>
                <td>${Number(investor.investment).toLocaleString()}</td>
                <td>${investor.percentage}%</td>
                <td>${investor.actualProfitPercentage}%</td>
                <td>${Number(investor.actualProfitAmount).toLocaleString()}</td>
            </tr>
        `;
    });
    
    html += `</tbody></table>`;
}

// Ø¬Ø¯ÙˆÙ„ Ø¬Ø¯ÛŒØ¯: Ø³ÙˆØ¯ Ù…Ø§Ù‡ Ø¬Ø§Ø±ÛŒ
if (result.currentMonthProfitData && result.currentMonthProfitData.investorsCurrentMonthProfitData.length > 0) {
    const monthNames = ["Ù…Ø§Ù†Ú¯ÛŒ - 1", "Ù…Ø§Ù†Ú¯ÛŒ - 2", "Ù…Ø§Ù†Ú¯ÛŒ - 3", "Ù…Ø§Ù†Ú¯ÛŒ - 4", "Ù…Ø§Ù†Ú¯ÛŒ - 5", "Ù…Ø§Ù†Ú¯ÛŒ - 6", 
                       "Ù…Ø§Ù†Ú¯ÛŒ - 7", "Ù…Ø§Ù†Ú¯ÛŒ - 8", "Ù…Ø§Ù†Ú¯ÛŒ - 9", "Ù…Ø§Ù†Ú¯ÛŒ - 10", "Ù…Ø§Ù†Ú¯ÛŒ - 11", "Ù…Ø§Ù†Ú¯ÛŒ - 12"];
    const currentMonthName = monthNames[result.currentMonthProfitData.currentMonth - 1];
    
    html += `
        <h3 style="margin-top: 40px;">Ù‚Ø§Ø²Ø§Ù†Ø¬ÛŒ Ù…Ø§Ù†Ú¯ÛŒ ${currentMonthName} ${result.currentMonthProfitData.currentYear}</h3>
        <p style="color: #666; margin-bottom: 15px; font-size: 16px;">
            Ù‚Ø§Ø²Ø§Ù†Ø¬ÛŒ Ù‚ÛŒØ³ØªÛ•Ú©Ø§Ù† Ø¦Û•Ù… Ù…Ø§Ù†Ú¯Û•
        </p>
        <table class="investors-table">
            <thead>
                <tr>
                    <th>Ù†Ø§Ùˆ</th>
                    <th>Ù…Û•Ø¨Ù„Û•ØºÛŒ Ø³Û•Ø±Ù…Ø§ÛŒÛ•</th>
                    <th>Ú•ÛÚ˜Û•ÛŒ Ø³Û•Ø±Ù…Ø§ÛŒÛ•</th>
                    <th>Ú•ÛÚ˜Û•ÛŒ Ù„Û• Ù‚Ø§Ø²Ø§Ù†Ø¬ÛŒ Ø³Ø§Ù„Ø§Ù†Û•</th>
                    <th>Ù‚Ø§Ø²Ø§Ù†Ø¬ÛŒ Ø¦Û•Ù… Ù…Ø§Ù†Ú¯Û•</th>
                    
                </tr>
            </thead>
            <tbody>
    `;
    
    result.currentMonthProfitData.investorsCurrentMonthProfitData.forEach(investor => {
        html += `
            <tr>
                <td>${investor.name}</td>
                <td>${Number(investor.investment).toLocaleString()}</td>
                <td>${investor.percentage}%</td>
                <td>${investor.currentMonthProfitPercentage}%</td>
                <td>${Number(investor.currentMonthProfitAmount).toLocaleString()}</td>
                
            </tr>
        `;
    });
    
    html += `</tbody></table>`;
    
    // Ø®Ù„Ø§ØµÙ‡ Ø³ÙˆØ¯ Ù…Ø§Ù‡ Ø¬Ø§Ø±ÛŒ
    html += `
    <div class="summary-section" style="margin-top: 20px;">
        <h4>Ú©ÙˆØ±ØªÛ•ÛŒ Ù‚Ø§Ø²Ø§Ù†Ø¬ÛŒ Ø¦Û•Ù… Ù…Ø§Ù†Ú¯Û•</h4>
        <div class="info-grid">
            <div class="info-item">
                <label>Ù‚Ø§Ø²Ø§Ù†Ø¬ÛŒ ØªÛ•ÙˆØ§ÙˆÛŒ Ø¦Û•Ù… Ù…Ø§Ù†Ú¯Û•:</label>
                <span>${Number(result.currentMonthProfitData.currentMonthTotalProfit).toLocaleString()}</span>
            </div>
        </div>
    </div>
`;
}

// Ø¯Ø± loadInvestorsDataØŒ Ø¨Ø¹Ø¯ Ø§Ø² Ø¬Ø¯ÙˆÙ„ Ø³ÙˆÙ… Ø§ÛŒÙ† Ø±Ùˆ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†:
html += `
  <div style="margin-top: 40px;">
    <h3 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px;">ğŸ’° Ø³Û•Ø±Ù…Ø§ÛŒÛ•ÛŒ Ø¨Û•Ø±Ø¯Û•Ø³ØªÛŒ Ø®Ø§ÙˆÛ•Ù† Ù¾Ø´Ú©Û•Ú©Ø§Ù†</h3>
    <table class="investors-table">
      <thead>
        <tr>
          <th>Ù†Ø§Ùˆ</th>
          <th>Ø³Û•Ø±Ù…Ø§ÛŒÛ•ÛŒ Ø³Û•Ø±Û•ØªØ§ÛŒÛŒ</th>
          <th>Ù‚Ø§Ø²Ø§Ù†Ø¬ÛŒ Ú©Û†ØªØ§ÛŒÛŒ</th>
          <th>Ù…Û•Ø¨Ù„Û•ØºÛŒ Ú©Û•Ù…Ú©Ø±Ø§Ùˆ</th>
          <th>Ù…Û•Ø¨Ù„Û•ØºÛŒ Ø¨Û•Ø±Ø¯Û•Ø³Øª</th>
          <th>Ù†Ø±Ø®ÛŒ Ø³Û•Ø±Ù…Ø§ÛŒÛ•</th>
        </tr>
      </thead>
      <tbody>
`;

// Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ GS Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ§Ù†Ø¯Ù† Ø¨Ø±Ø¯Ø§Ø´Øªâ€ŒÙ‡Ø§
google.script.run
  .withSuccessHandler(function(withdrawalsData) {
    // Ø§ÛŒÙ† Ù‚Ø³Ù…Øª Ø¨Ø¹Ø¯Ø§Ù‹ Ù¾Ø± Ù…ÛŒØ´Ù‡
    console.log('Ø¨Ø±Ø¯Ø§Ø´Øªâ€ŒÙ‡Ø§:', withdrawalsData);
  })
  .withFailureHandler(function(error) {
    console.log('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¨Ø±Ø¯Ø§Ø´Øªâ€ŒÙ‡Ø§:', error);
  })
  .getWithdrawalsSummary();

// ÙØ¹Ù„Ø§Ù‹ Ø¨Ø§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ù†Ù…Ø§ÛŒØ´ Ù…ÛŒØ¯ÛŒÙ…
result.investorsData.forEach(investor => {
  html += `
        <tr>
          <td><strong>${investor.name}</strong></td>
          <td>${investor.investment.toLocaleString()}</td>
          <td style="color: #27ae60;">${investor.profitAmount.toLocaleString()}</td>
          <td style="color: #e74c3c;" id="withdrawals-${investor.name}">Ø¯Ø±Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</td>
          <td style="color: #2980b9; font-weight: 700;" id="balance-${investor.name}">Ø¯Ø±Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</td>
          <td>${investor.percentage}%</td>
        </tr>
  `;
});

html += `
      </tbody>
    </table>
    <p style="text-align: center; color: #7f8c8d; margin-top: 10px; font-size: 12px;">
      Ù…Û•Ø¨Ù„Û•ØºÛŒ Ø¨Û•Ø±Ø¯Û•Ø³Øª = Ù‚Ø§Ø²Ø§Ù†Ø¬ÛŒ Ú©Û†ØªØ§ÛŒÛŒ - Ú©Û†ÛŒ Ú©Û•Ù…Ú©Ø±Ø§ÙˆÛ•Ú©Ø§Ù†
    </p>
  </div>
`;

// ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¢Ù¾Ø¯ÛŒØª Ø¬Ø¯ÙˆÙ„ Ø¨Ø¹Ø¯ Ø§Ø² Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
setTimeout(function() {
  google.script.run
    .withSuccessHandler(function(withdrawalsData) {
      if (withdrawalsData.success) {
        withdrawalsData.summary.forEach(investor => {
          const withdrawalsCell = document.getElementById('withdrawals-' + investor.name);
          const balanceCell = document.getElementById('balance-' + investor.name);
          
          if (withdrawalsCell && balanceCell) {
            withdrawalsCell.textContent = investor.totalWithdrawals.toLocaleString();
            balanceCell.textContent = Math.max(0, investor.potentialProfit - investor.totalWithdrawals).toLocaleString();
          }
        });
      }
    })
    .withFailureHandler(function(error) {
      console.log('Ø®Ø·Ø§:', error);
      // Ù†Ù…Ø§ÛŒØ´ Ø®Ø·Ø§
      result.investorsData.forEach(investor => {
        const withdrawalsCell = document.getElementById('withdrawals-' + investor.name);
        if (withdrawalsCell) {
          withdrawalsCell.textContent = 'Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ';
          withdrawalsCell.style.color = '#e74c3c';
        }
      });
    })
    .getWithdrawalsSummary();
}, 1000);
     
                // Ø¬Ø¯ÙˆÙ„ ÙØ±Û†Ø´ÛŒØ§Ø±Û•Ú©Ø§Ù†
                if (result.froshyarData && result.froshyarData.length > 0) {
                    html += `
                        <h3 style="margin-top: 40px;">ÙØ±Û†Ø´ÛŒØ§Ø±Û•Ú©Ø§Ù†</h3>
                        <table class="investors-table">
                            <thead>
                                <tr>
                                    <th>Ù†Ø§Ùˆ</th>
                                    <th>Ú˜Ù…Ø§Ø±Û•ÛŒ ÙØ±Û†Ø´ØªÙ†</th>
                                    <th>Ú©Û†ÛŒ Ù‚Ø§Ø²Ø§Ù†Ø¬</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    
                    result.froshyarData.forEach(froshyar => {
                        html += `
                            <tr>
                                <td>${froshyar.name}</td>
                                <td>${froshyar.count}</td>
                                <td>${Number(froshyar.totalProfit).toLocaleString()}</td>
                            </tr>
                        `;
                    });
                    
                    html += `</tbody></table>`;
                } else {
                    html += `<p style="margin-top: 40px;">Ù‡ÛŒÚ† Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛ•Ú©ÛŒ ÙØ±Û†Ø´ÛŒØ§Ø±Û•Ú©Ø§Ù† Ù†ÛŒÛ•</p>`;
                }

                
              // Ø®Ù„Ø§ØµÙ‡
const totalAllProfit = result.investorsProfit + result.froshyarProfit;

html += `
    <div class="summary-section">
        <h4>Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ</h4>
        <div class="info-grid">
            <div class="info-item">
                <label>Ú©Û†ÛŒ Ø³Û•Ø±Ù…Ø§ÛŒÛ•:</label>
                <span>${Number(result.totalInvestment).toLocaleString()}</span>
            </div>
            <div class="info-item">
                <label>Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ Ù‚Ø§Ø²Ø§Ù†Ø¬ ØªØ§ Ø¦ÛØ³ØªØ§:</label>
                <span>${Number(totalAllProfit).toLocaleString()}</span>
            </div>
            <div class="info-item">
                <label>Ù‚Ø§Ø²Ø§Ù†Ø¬ÛŒ Ø±Ø§Ø³ØªÛ•Ù‚ÛŒØ³Ù†Û•ÛŒ Ø®Ø§ÙˆÛ•Ù† Ù¾Ø´Ú©Û•Ú©Ø§Ù† ØªØ§ Ø¦ÛØ³ØªØ§:</label>
                <span>${Number(result.actualProfitData.investorsActualProfit).toLocaleString()}</span>
            </div>
            <div class="info-item">
                <label>Ù‚Ø§Ø²Ø§Ù†Ø¬ÛŒ ÙØ±Û†Ø´ÛŒØ§Ø±Ø§Ù† ØªØ§ Ø¦ÛØ³ØªØ§:</label>
                <span>${Number(result.froshyarProfit).toLocaleString()}</span>
            </div>
            <div class="info-item">
                <label>Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ Ù‚Ø§Ø²Ø§Ù†Ø¬ÛŒ Ú©Û†ØªØ§ÛŒÛŒ:</label>
                <span>${Number(result.totalProfit).toLocaleString()}</span>
            </div>
        </div>
    </div>
`;
                
                investorsContent.innerHTML = html;
            } else {
                investorsContent.innerHTML = '<p>Ù‡ÛŒÚ† Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛ•Ú©ÛŒ Ø®Ø§ÙˆÛ•Ù† Ù¾Ø´Ú©Û•Ú©Ø§Ù† Ù†ÛŒÛ•</p>';
            }
        })
        .withFailureHandler(function(error) {
            console.error('Ù‡Û•Ù„Û• Ù„Û• ÙˆÛ•Ø±Ú¯Ø±ØªÙ†ÛŒ Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ Ø®Ø§ÙˆÛ•Ù† Ù¾Ø´Ú©Û•Ú©Ø§Ù†:', error);
            investorsContent.innerHTML = '<p>Ù‡Û•Ù„Û• Ù„Û• Ø¦Ø§Ù…Ø§Ø¯Û•Ú©Ø±Ø¯Ù†ÛŒ Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ Ø®Ø§ÙˆÛ•Ù† Ù¾Ø´Ú©Û•Ú©Ø§Ù†</p>';
        })
        .getInvestorsData();

        // Ø¬Ø¯ÙˆÙ„ Ú†Ù‡Ø§Ø±Ù… Ø³Ø§Ø¯Ù‡ - Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ùˆ Ø¨Ø±Ø¯Ø§Ø´Øª
try {
  const balanceData = getSimpleBalanceTable();
  if (balanceData.success) {
    html += `
      <div style="margin-top: 40px;">
        <h3 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px;">ğŸ’° Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ùˆ Ø¨Ø±Ø¯Ø§Ø´Øªâ€ŒÙ‡Ø§</h3>
        <table class="investors-table">
          <thead>
            <tr>
              <th>Ù†Ø§Ù…</th>
              <th>Ø³Ø±Ù…Ø§ÛŒÙ‡ Ø§ÙˆÙ„ÛŒÙ‡</th>
              <th>Ø³ÙˆØ¯ ØªØ®Ù…ÛŒÙ†ÛŒ</th>
              <th>Ø¬Ù…Ø¹ Ø¨Ø±Ø¯Ø§Ø´Øªâ€ŒÙ‡Ø§</th>
              <th>Ù…ÙˆØ¬ÙˆØ¯ÛŒ ÙØ¹Ù„ÛŒ</th>
            </tr>
          </thead>
          <tbody>
    `;
    
    balanceData.summary.forEach(investor => {
      html += `
            <tr>
              <td><strong>${investor.name}</strong></td>
              <td>${investor.initialInvestment.toLocaleString()}</td>
              <td style="color: #27ae60;">${investor.totalProfit.toLocaleString()}</td>
              <td style="color: #e74c3c;">${investor.totalWithdrawals.toLocaleString()}</td>
              <td style="color: #2980b9; font-weight: 700;">${investor.currentBalance.toLocaleString()}</td>
            </tr>
      `;
    });
    
    html += `
          </tbody>
        </table>
        <p style="text-align: center; color: #7f8c8d; margin-top: 10px; font-size: 12px;">
          * Ø³ÙˆØ¯ ØªØ®Ù…ÛŒÙ†ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ 10% Ø³Ø±Ù…Ø§ÛŒÙ‡ Ø§ÙˆÙ„ÛŒÙ‡ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø´Ø¯Ù‡ Ø§Ø³Øª
        </p>
      </div>
    `;
  } else {
    html += `<p style="color: #e74c3c; text-align: center;">Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¬Ø¯ÙˆÙ„ Ù…ÙˆØ¬ÙˆØ¯ÛŒ: ${balanceData.error}</p>`;
  }
} catch (error) {
  html += `<p style="color: #e74c3c; text-align: center;">Ø®Ø·Ø§: ${error.toString()}</p>`;
}
}


        // Ù†Ù…Ø§ÛŒØ´ Ø®Ø·Ø§
        function showError(message) {
            alert('Ù‡Û•Ù„Û•: ' + message);
        }


// ØªØ§Ø¨Ø¹ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† - Ø§Ø² ØªØ¨ Ú¯Ø²Ø§Ø±Ø´Ø§Øª PDF Ø¨Ú¯ÛŒØ±
function generatePDF(tabId) {
    console.log('Ø¯Û•Ø±Ú©Ø±Ø¯Ù†ÛŒ PDF Ø¨Û†:', tabId);
    
    // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ø¨Ø®Ø´ Ú¯Ø²Ø§Ø±Ø´Ø§Øª
    const reportContainer = document.querySelector(`#${tabId} .excel-style-report`);
    
    if (!reportContainer) {
        alert('Ù‡ÛŒÚ† Ø±Ø§Ù¾Û†Ø±ØªÛÚ© Ø¨Û•Ø±Ø¯Û•Ø³Øª Ù†ÛŒÛ•');
        return;
    }
    
    const options = {
        margin: 10,
        filename: `QARZAKAN-${new Date().toISOString().split('T')[0]}.pdf`,
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
    };

    // Ø§ÛŒØ¬Ø§Ø¯ PDF Ù…Ø³ØªÙ‚ÛŒÙ… Ø§Ø² Ú¯Ø²Ø§Ø±Ø´Ø§Øª
    html2pdf()
        .from(reportContainer)
        .set(options)
        .save();
}



        // Ø¢Ø¯Ø±Ø³ GS Ø´Ù…Ø§
const GS_URL = 'https://script.google.com/macros/s/AKfycbzzY5xhhN6QNcYDFdkUnNk1MOaxcwSF9Rk8Ka7cIlyljihN_PkZwBLmuoS114Ax8ia2gg/exec';

// ØªØ§Ø¨Ø¹ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ø¨Ø±Ø§ÛŒ google.script.run
async function callGS(functionName, data = {}) {
    try {
        console.log('ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ ØªØ§Ø¨Ø¹:', functionName, data);
        
        const response = await fetch(GS_URL, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: `function=${functionName}&data=${JSON.stringify(data)}`
        });
        
        const result = await response.json();
        console.log('Ù†ØªÛŒØ¬Ù‡:', result);
        return result;
        
    } catch (error) {
        console.error('Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ GS:', error);
        return { error: error.toString() };
    }
}

// Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ú©Ø±Ø¯Ù† google.script.run
window.google = {
    script: {
        run: {
            withSuccessHandler: (successHandler) => ({
                withFailureHandler: (failureHandler) => ({
                    // Ø¨Ø±Ø§ÛŒ ØªÙˆØ§Ø¨Ø¹ Ø¨Ø¯ÙˆÙ† Ù¾Ø§Ø±Ø§Ù…ØªØ±
                    getWaragrList: () => callGS('getWaragrList').then(successHandler).catch(failureHandler),
                    getSystemReports: () => callGS('getSystemReports').then(successHandler).catch(failureHandler),
                    getInvestorsData: () => callGS('getInvestorsData').then(successHandler).catch(failureHandler),
                    getUniqueWaragrNames: () => callGS('getUniqueWaragrNames').then(successHandler).catch(failureHandler),
                    updateAllData: () => callGS('updateAllData').then(successHandler).catch(failureHandler),
                    
                    // Ø¨Ø±Ø§ÛŒ ØªÙˆØ§Ø¨Ø¹ Ø¨Ø§ Ù¾Ø§Ø±Ø§Ù…ØªØ±
                    getWaragrInfo: (waragrName, loanType) => callGS('getWaragrInfo', {waragrName, loanType}).then(successHandler).catch(failureHandler),
                    getAllLoansForWaragr: (waragrName) => callGS('getAllLoansForWaragr', {waragrName}).then(successHandler).catch(failureHandler),
                    saveNewLoan: (formData) => callGS('saveNewLoan', formData).then(successHandler).catch(failureHandler),
                    saveInstallment: (formData) => callGS('saveInstallment', formData).then(successHandler).catch(failureHandler)
                })
            })
        }
    }
};

// ØªØ³Øª Ø§Ø±ØªØ¨Ø§Ø·
console.log('ğŸ”— PWA ÙØ¹Ø§Ù„ Ø´Ø¯ - Ù…Ù†ØªØ¸Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ GS...');

// Ù†Ù…Ø§ÛŒØ´ Ø¯Ú©Ù…Ù‡ Ù†ØµØ¨ PWA
window.addEventListener('beforeinstallprompt', (e) => {
    console.log('ğŸ“± Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù‚Ø§Ø¨Ù„ Ù†ØµØ¨ Ø§Ø³Øª');
    
    const installBtn = document.createElement('button');
    installBtn.innerHTML = 'ğŸ“² Ù†ØµØ¨ Ø¨Ø±Ù†Ø§Ù…Ù‡';
    installBtn.style.cssText = `
        position: fixed;
        top: 100px;
        left: 10px;
        z-index: 10000;
        background: #2ecc71;
        color: white;
        border: none;
        padding: 12px 16px;
        border-radius: 25px;
        font-size: 14px;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 0 4px 12px rgba(46, 204, 113, 0.3);
        font-family: Vazirmatn, sans-serif;
    `;
    
    installBtn.onclick = async () => {
        e.prompt();
        installBtn.style.display = 'none';
    };
    
    document.body.appendChild(installBtn);
});
    </script>
</body>
</html>

